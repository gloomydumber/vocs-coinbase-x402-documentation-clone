---
title: x402 작동 방식
---

이 페이지에서는 최초 요청부터 지불 결제까지 x402에서의 전체 지불 흐름을 설명합니다.

## 개요

x402는 간단한 요청-응답 흐름을 통해 HTTP를 통한 프로그래밍 방식 결제를 지원합니다.
클라이언트가 유료 리소스를 요청하면 서버는 결제 요구 사항을 포함하여 응답하고, 클라이언트는 결제를 제출하며, 서버는 해당 리소스를 전달합니다.

## 결제 흐름

![x402-protocol-flow](/x402-protocol-flow.avif)

### 단계별 프로세스

1. **클라이언트가 HTTP 요청** - [**클라이언트**](https://docs.cdp.coinbase.com/x402/core-concepts/client-server)는 보호된 엔드포인트에 대한 리소스 서버에 표준 HTTP 요청을 보냅니다.
2. **서버가 402로 응답** - 리소스 서버는 응답 본문에 결제 세부 정보와 함께
   [**HTTP 402 Payment Required**](https://docs.cdp.coinbase.com/x402/core-concepts/http-402) 상태 코드를 반환합니다.
3. **클라이언트가 결제를 생성** - 클라이언트는 결제 요구 사항을 검토하고 지정된 방식에 따라
   [**지갑**](https://docs.cdp.coinbase.com/x402/core-concepts/wallet)을 사용하여 결제 페이로드를 생성합니다.
4. **클라이언트가 결제를 다시 제출** - 클라이언트가 동일한 HTTP 요청을 다시 전송하는데, 이번에는 `X-PAYMENT` 서명된 결제 페이로드가 포함된 헤더를 포함합니다.
5. **서버가 지불을 검증** - 리소스 서버는 다음 중 하나를 통해 지불 페이로드를 검증합니다.
   - 로컬로(자체 검증을 실행하는 경우)
   - [**Facilitator**](https://docs.cdp.coinbase.com/x402/core-concepts/facilitator) 를 통해 (권장)
6. **촉진자 검증** - 촉진자를 이용하는 경우, 촉진자는 지불을 계획 및 네트워크 요구 사항에 맞춰 검증하고 검증 응답을 반환합니다.
7. **서버가 요청을 처리** - 결제가 유효하면 서버는 원래 요청을 처리합니다. 유효하지 않으면 402 응답을 다시 반환합니다.
8. **결제 정산** - 서버는 다음 중 하나를 통해 블록체인 결제를 시작합니다.
   - 블록체인에 직접 제출하여
   - 촉진자의 `/settle` 종점을 통해
9. **Facilitator가 블록체인에 제출** - 중개자는 결제 네트워크를 기반으로 블록체인에 거래를 브로드캐스트하고 확인을 기다립니다.
10. **결제 확인** - 체인상에서 확인되면, 촉진자는 결제 실행 응답을 반환합니다.
11. **서버가 리소스를 전달** - 서버는 다음과 같은 200 OK 응답을 반환합니다.
    - 응답 본문에서 요청된 리소스
    - `X-PAYMENT-RESPONSE` 결제 세부 정보가 포함된 헤더

## 주요 구성 요소

[**클라이언트 및 서버**](https://docs.cdp.coinbase.com/x402/core-concepts/client-server) - 각 당사자의 역할 및 책임
[**Facilitator**](https://docs.cdp.coinbase.com/x402/core-concepts/facilitator) - 지불 검증 및 정산을 처리하는 선택적 서비스
[**HTTP 402**](https://docs.cdp.coinbase.com/x402/core-concepts/http-402) - 결제 요구 사항이 전달되는 방식
[**네트워크 및 촉진자**](https://docs.cdp.coinbase.com/x402/network-support) - 사용 가능한 네트워크 및 촉진자 옵션

## 왜 이런 디자인을 했을까?

x402 프로토콜은 다음과 같이 설계되었습니다.

- **상태 비저장** - 세션이나 인증이 필요하지 않습니다.
- **HTTP 네이티브** - 기존 웹 인프라와 함께 작동합니다.
- **블록체인 독립적** - 촉진자를 통해 여러 네트워크 지원
- **개발자 친화적** - 표준 HTTP 라이브러리와의 간단한 통합

## 다음 단계

- 결제를 받을 준비가 되셨나요? [**판매자를 위한 빠른 시작**](https://docs.cdp.coinbase.com/x402/quickstart-for-sellers)을 참조하세요.
- 결제를 원하시나요? [**구매자를 위한 빠른 시작**](https://docs.cdp.coinbase.com/x402/quickstart-for-buyers)을 참조하세요.
- 특정 네트워크를 찾고 계신가요? [**네트워크 지원**](https://docs.cdp.coinbase.com/x402/network-support)을 확인하세요.
