# Coinbase x402

## MCP Server with x402

[**모델 컨텍스트 프로토콜(MCP)**](https://www.modelcontextprotocol.io/)은 LLM과 다른 AI 에이전트 간에 컨텍스트를 전달하는 프로토콜입니다.
이 페이지에서는 MCP와 함께 x402 결제 프로토콜을 사용하여 MCP 서버를 통해 유료 API 요청을 전송하고, 이를 Claude Desktop에 연결하는 방법을 보여줍니다.

### 이 통합은 무엇인가요?

이 가이드에서는 x402 프로토콜을 사용하여 유료 API에 액세스할 수 있는 MCP 서버를 실행하는 방법을 안내합니다.
MCP 서버는 Claude Desktop(또는 MCP 호환 클라이언트)과 유료 API(예: x402 저장소의 샘플 날씨 API)를 연결하는 다리 역할을 합니다.
Claude(또는 다른 에이전트)가 도구를 호출하면 MCP 서버는 다음을 수행합니다.

* API가 결제를 요구하는지 감지합니다(HTTP 402를 통해)
* 지갑을 사용하여 자동으로 결제를 처리합니다.
* 유료 데이터를 클라이언트(예: Claude)에게 반환합니다.

이를 통해 귀하(또는 귀하의 AI 에이전트)는 수동 결제 단계 없이 유료 API에 프로그래밍 방식으로 액세스할 수 있습니다.

### 필수 조건

* Node.js(v20 이상)
* 연결할 x402 호환 서버(이 데모에서는 x402 저장소의 [**날씨 데이터**](https://github.com/coinbase/x402/tree/main/examples/typescript/servers/express)나
  외부 x402 API가 있는 샘플 Express 서버를 사용합니다)
* USDC가 있는 Ethereum 지갑(Base Sepolia 또는 Base Mainnet)
* [**MCP 지원이 포함된 Claude Desktop**](https://claude.ai/download)

### 단계별: MCP + x402 통합 구축

[**x402 저장소**](https://github.com/coinbase/x402/tree/main/examples/typescript/mcp)에서 이 코드의 바로 사용 가능한 버전을 찾을 수 있습니다.
아래에서 각 단계를 설명하여 작동 방식을 이해하고 필요에 맞게 조정할 수 있도록 도와드리겠습니다.

#### 1. 종속성 설치

```shell
npm install @modelcontextprotocol/sdk axios viem x402-axios dotenv
```

#### 2. 환경 변수 설정

`.env` 프로젝트 루트에 파일을 만듭니다.

```text
PRIVATE_KEY=0xYourTestnetPrivateKey
RESOURCE_SERVER_URL=http://localhost:4021
ENDPOINT_PATH=/weather
```

* `PRIVATE_KEY`: EVM 지갑의 개인 키(결제 서명용)
* `RESOURCE_SERVER_URL`: 유료 API의 기본 URL(이 데모에서는 샘플 Express 서버를 사용하세요)
* `ENDPOINT_PATH`: 특정 종료점 경로(예: `/weather`)

#### 3. 구현: x402 결제를 지원하는 MCP 서버

```javascript
import { McpServer } from "@modelcontextprotocol/sdk/server/mcp.js";
import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";
import axios from "axios";
import { Hex } from "viem";
import { privateKeyToAccount } from "viem/accounts";
import { withPaymentInterceptor } from "x402-axios";
import { config } from "dotenv";

// Load environment variables and throw an error if any are missing
config();

const privateKey = process.env.PRIVATE_KEY as Hex;
const baseURL = process.env.RESOURCE_SERVER_URL as string; // e.g. https://example.com
const endpointPath = process.env.ENDPOINT_PATH as string; // e.g. /weather

if (!privateKey || !baseURL || !endpointPath) {
  throw new Error("Missing environment variables");
}

// Create a wallet client to handle payments
const account = privateKeyToAccount(privateKey);

// Create an axios client with payment interceptor using x402-axios
const client = withPaymentInterceptor(axios.create({ baseURL }), account);

// Create an MCP server
const server = new McpServer({
  name: "x402 MCP Client Demo",
  version: "1.0.0",
});

// Add an addition tool
server.tool(
  "get-data-from-resource-server",
  "Get data from the resource server (in this example, the weather)", //change this
  description to change when the client calls the tool
  {},
  async () => {
    const res = await client.get(endpointPath);
    return {
      content: [{ type: "text", text: JSON.stringify(res.data) }],
    };
  },
);

const transport = new StdioServerTransport();
await server.connect(transport);
```

### 작동 원리

* MCP 서버는 호출 시 유료 API 엔드포인트에서 데이터를 가져오는 도구를 제공합니다.
* 엔드포인트에 결제가 필요한 경우 x402-axios 인터셉터는 여러분의 월렛을 사용하여 결제 핸드셰이크를 처리합니다.
* 결제가 완료되면 데이터가 MCP 클라이언트(예: Claude Desktop)로 반환됩니다.

### Claude Desktop에 MCP 서버 추가

Claude Desktop과 이 통합을 사용하려면:

1. Claude Desktop을 열고 MCP 설정으로 이동합니다.
2. 다음 구성으로 새로운 MCP 서버를 추가합니다(필요에 따라 경로를 조정합니다):

```json
{
  "mcpServers": {
    "demo": {
      "command": "pnpm",
      "args": [
        "--silent",
        "-C",
        "<absolute path to this repo>/examples/typescript/clients/mcp",
        "dev"
      ],
      "env": {
        "PRIVATE_KEY": "<private key of a wallet with USDC on Base Sepolia>",
        "RESOURCE_SERVER_URL": "http://localhost:4021",
        "ENDPOINT_PATH": "/weather"
      }
    }
  }
}
```

3. x402 호환 서버(예: 샘플 익스프레스 서버)가 실행 중이고 귀하가 제공한 URL에서 접근 가능한지 확인하세요.
4. MCP 클라이언트를 시작합니다(예: `pnpm dev` 클라이언트 디렉토리에서).
5. 이제 Claude는 도구를 호출하여 유료 데이터를 받을 수 있습니다!

### 요소 간 연동 방식

* **x402 호환 서버** : 유료 API(예: 날씨 데이터)를 호스팅합니다. 결제가 필요한 경우 HTTP 402 응답 코드로 응답합니다.
* **MCP 서버(이 문서에서 다루는 구현체)** : 브리지 역할을 하며 결제를 처리하고 MCP 클라이언트에 도구를 노출합니다.
* **Claude Desktop** : MCP 도구를 호출하고, 유료 데이터를 수신하여 사용자에게 표시합니다.

### 다음 단계

* [**리포지토리**](https://github.com/coinbase/x402/tree/main/examples/typescript/mcp)에서 예제 확인
* 여러분이 자체적으로 구성한 x402 호환 API와 연동 시도 해보기
* 필요에 따라 더 많은 도구나 사용자 정의 논리를 사용하여 MCP 서버 확장하기


## x402로 미니앱 빌드

이 가이드에서는 공식 템플릿을 사용하여 x402 결제를 통합하는 미니앱을 구축하는 방법을 설명합니다.
이 템플릿은 지갑 통합, 결제 보호, 알림 기능이 미리 구성되어 있어 완벽한 시작점을 제공합니다.

### 미니앱이란 무엇인가요?

미니앱은 TBA와 같은 Farcaster 클라이언트 내에서 실행되는 경량 애플리케이션입니다.
MiniKit 으로 구축되어 Farcaster의 소셜 그래프 및 지갑 기능을 활용하면서 네이티브 앱과 유사한 경험을 제공합니다.
x402를 통합하면 사용자가 앱을 나가거나 복잡한 결제 흐름을 관리할 필요 없이 미니앱에서 즉시 USDC 결제를 처리할 수 있습니다.

### 미니앱에 x402를 사용하는 이유는?

x402는 다음과 같은 이유로 미니앱에 특히 적합합니다.

* **원활한 결제** : 사용자는 미니앱 환경을 벗어나지 않고도 결제할 수 있습니다.
* **계정 설정 없음** : 연결된 지갑과 직접 작동
* **즉각적인 수익 창출** : 빌더는 콘텐츠나 서비스를 직접 수익화할 수 있습니다.
* **간단한 통합** : 미들웨어 구성만으로 결제 보호

### 필수 조건

시작하기 전에 다음 사항을 확인하세요.

* Node.js 18+ 및 pnpm v10 설치됨
* Coinbase [**개발자 플랫폼**](https://portal.cdp.coinbase.com/) 계정 및 API 키(메인넷용)
* 결제를 받을 지갑 주소

### x402 템플릿을 사용한 빠른 시작

x402 기반 미니앱을 빌드하는 가장 빠른 방법은 공식 템플릿을 사용하는 것입니다.

```shell
# Clone the x402 repository
git clone https://github.com/coinbase/x402.git
cd x402/examples/typescript/fullstack/farcaster-miniapp

# Install dependencies
pnpm install

# Build all packages (required for monorepo)
cd ../../
pnpm build
cd fullstack/farcaster-miniapp

# Copy environment variables
cp env.example .env.local

# Configure your environment (see below)
# Then start the development server
pnpm dev
```

### 템플릿 기능

x402 미니앱 템플릿에는 다음이 포함됩니다.

* TypeScript를 사용한 **Next.js 앱 라우터**
* 지갑 연결을 위한 **OnchainKit 통합**
* 보호된 경로를 위한 **x402 결제 미들웨어**
* 미니앱 감지를 위한 **Farcaster Frame SDK**
* Redis/Upstash를 이용한 **알림 시스템**

### 프로젝트 구조

```text
farcaster-miniapp/
├── app/
│   ├── .well-known/
│   │   └── farcaster.json/    # Dynamic Frame configuration
│   │       └── route.ts
│   ├── api/
│   │   ├── notify/            # Notification proxy endpoint
│   │   ├── protected/         # x402-protected endpoint
│   │   └── webhook/           # Frame webhook handler
│   ├── page.tsx               # Main miniapp interface
│   ├── layout.tsx             # Root layout with providers
│   ├── providers.tsx          # MiniKit and wallet providers
│   └── globals.css            # Global styles
├── lib/
│   └── notification-client.ts # Notification utilities
├── middleware.ts              # x402 payment middleware
└── .env.local                 # Environment configuration
```

### 환경 구성

`.env.local` 구성을 포함하는 파일을 만듭니다 .

#### x402 지불에 필요한 환경 변수

```bash
# Your wallet address to receive payments
RESOURCE_WALLET_ADDRESS=0xYourWalletAddress

# Network: "base-sepolia" for testing, "base" for production
NETWORK=base-sepolia

# OnchainKit API key (get from https://portal.cdp.coinbase.com/products/onchainkit)
NEXT_PUBLIC_ONCHAINKIT_API_KEY=your_api_key_here
NEXT_PUBLIC_ONCHAINKIT_PROJECT_NAME=x402 Mini App

# For mainnet only (get from portal.cdp.coinbase.com)
CDP_API_KEY_ID=your_cdp_key_id
CDP_API_KEY_SECRET=your_cdp_key_secret
```

#### 프레임 구성(자동 생성)

다음 명령을 실행하여 프레임 구성을 생성합니다.

```shell
npx create-onchain --manifest
```

이렇게 하면 다음에 필요한 환경 변수가 생성됩니다.

* 프레임 메타데이터 및 계정 연결
* Redis/Upstash를 통한 알림 지원
* 미니 앱 감지 및 통합

### 템플릿 작동 방식

#### 1. 결제 미들웨어 설정

이 `middleware.ts` 파일은 x402를 구성하여 API 경로를 보호합니다.

```typescript
import { facilitator } from "@coinbase/x402";
import { paymentMiddleware } from "x402-next";

const payTo = process.env.RESOURCE_WALLET_ADDRESS as Address;
const network = process.env.NETWORK || "base-sepolia";

export const middleware = paymentMiddleware(
  payTo,
  {
    "/api/protected": {
      price: "$0.01",
      network,
      config: {
        description: "Protected route",
      },
    },
  },
  facilitator
);

export const config = {
  matcher: ["/api/protected"],
  runtime: "nodejs",
};
```

#### 2. 보호된 API 엔드포인트

엔드포인트 는 `/api/protected/route.ts` 자동으로 보호됩니다.

```typescript
import { NextResponse } from "next/server";

export async function GET() {
  // This only executes if payment is verified
  return NextResponse.json({
    success: true,
    message: "Protected action completed successfully",
    timestamp: new Date().toISOString(),
  });
}
```

#### 3. 프런트엔드 통합

메인 페이지는 지갑 연결과 보호된 API 호출을 보여줍니다.

```javascript
import { wrapFetchWithPayment } from "x402-fetch";
import { getWalletClient } from "wagmi/actions";

// Get wallet client from wagmi
const walletClient = await getWalletClient(config, {
  account: address,
  chainId: chainId,
  connector: connector,
});

// Wrap fetch with x402 payment handling
const fetchWithPayment = wrapFetchWithPayment(fetch, walletClient);

// Call protected endpoint - payment is handled automatically
const response = await fetchWithPayment("/api/protected");
```

#### 4. 미니앱 감지

템플릿은 Farcaster 내부에서 실행될 때 다음을 감지합니다.

```tsx
import { sdk } from "@farcaster/frame-sdk";

useEffect(() => {
  const initMiniApp = async () => {
    await sdk.actions.ready();
    const isInMiniApp = await sdk.isInMiniApp();
    setIsInMiniApp(isInMiniApp);
  };
  initMiniApp();
}, []);
```

### 템플릿 사용자 정의

#### 더 많은 보호 경로 추가

새로운 보호된 엔드포인트를 추가하기 위한 업데이트 `middleware.ts`:

```typescript
export const middleware = paymentMiddleware(
  payTo,
  {
    "/api/protected": {
      price: "$0.01",
      network,
    },
    "/api/premium-content": {
      price: "$1.00",
      network,
      config: {
        description: "Premium content access",
      },
    },
    "/api/exclusive-feature": {
      price: "$5.00",
      network,
      config: {
        description: "Exclusive feature unlock",
      },
    },
  },
  facilitator
);

export const config = {
  matcher: ["/api/protected", "/api/premium-content", "/api/exclusive-feature"],
};
```

#### 알림 구현

템플릿에는 Redis를 통한 알림 지원이 포함되어 있습니다.

```typescript
import { sendFrameNotification } from "@/lib/notification-client";

// Send a notification after successful payment
await sendFrameNotification({
  fid: userFid,
  title: "Payment Successful!",
  body: "You've unlocked premium content",
  notificationDetails: {
    url: "/premium",
    type: "payment_success",
  },
});
```

#### UI 사용자 정의

이 템플릿은 픽셀 테마의 Tailwind CSS를 사용합니다. 다음을 수정하여 `theme.css` 사용자 정의하세요.

```css
/* Custom theme variables */
:root {
  --ockThemePrimary: #4f46e5;
  --ockThemeSecondary: #7c3aed;
  --ockConnectWalletBackground: #ffffff;
  /* ... more theme variables ... */
}
```

### 미니앱 테스트

#### 로컬에서 개발

1. 개발 서버를 시작하세요:

```shell
pnpm dev
```

2. 브라우저에서 [**http://localhost:3000**](http://localhost:3000)을 엽니다 .
3. 지갑 연결 및 보호된 API 호출 테스트

#### Farcaster에서 테스트

1. ngrok을 사용하여 로컬 서버를 노출하세요.

```shell
ngrok http 3000
```

2. ngrok URL로 `NEXT_PUBLIC_URL` 업데이트 하세요 `.env.local`
3. Warpcast에서 테스트하기 위해 프레임 URL을 캐스팅하세요
4. 미니앱에는 "앱 사용" 버튼이 표시됩니다.

### 배포

#### 프로덕션 체크리스트

* `NETWORK=base` 메인넷을 위해 설정됨
* 메인넷 결제를 위한 CDP API 키 구성
* `RESOURCE_WALLET_ADDRESS` 프로덕션 지갑을 업데이트하세요
* `NEXT_PUBLIC_URL` 도메인에 맞게 적절하게 설정하세요
* 테스트넷에서 먼저 지불 흐름을 철저히 테스트합니다.
* 프로덕션 알림을 위해 Redis 구성

### 모범 사례

#### 사용자 경험

* **명확한 가격** : 결제를 요구하기 전에 항상 가격을 표시합니다.
* **로딩 상태** : 결제 처리 중 진행 상황 표시
* **오류 처리** : 명확한 오류 메시지와 복구 옵션 제공
* **성공 피드백\*** : 성공적인 결제를 즉시 확인하세요

#### 보안

* **환경 변수** : 민감한 키를 절대 커밋하지 마세요
* **서버 검증** : 항상 서버 측에서 결제를 검증하세요
* **네트워크 확인** : 사용자가 올바른 네트워크에 있는지 확인하세요
* **속도 제한** : 보호된 엔드포인트에 속도 제한을 추가하는 것을 고려하세요.

### 일반적인 문제 및 해결 방법

#### 결제가 처리되지 않음

```typescript
// Ensure wallet client is properly configured
if (!walletClient) {
  console.error("Wallet client not available");
  return;
}

// Check network matches configuration
if (chainId !== expectedChainId) {
  console.error("Wrong network");
  return;
}
```

#### 미니앱이 감지되지 않음

```typescript
// Ensure Frame SDK is initialized
try {
  await sdk.actions.ready();
} catch (error) {
  console.log("Not in miniapp context");
}
```

#### 402 오류가 처리되지 않음

```typescript
// Verify middleware matcher includes your route
export const config = {
  matcher: ["/api/your-route"], // Add your route here
};
```

### 다음 단계

1. **템플릿 탐색** : 예제 저장소 의 모든 파일 검토
2. **사용 사례에 맞게 사용자 정의** : 특정 요구 사항에 맞게 템플릿을 수정하세요.
3. **기능 추가** : 결제 기반 위에 구축
4. **배포 및 공유** : Farcaster 커뮤니티에 미니앱을 출시하세요

### 지원

* [**x402 문서**](https://docs.cdp.coinbase.com/x402)
* [**OnchainKit 문서**](https://onchainkit.xyz/)
* [**Farcaster Mini 앱 가이드**](https://miniapps.farcaster.xyz/)
* [**CDP Discord 커뮤니티**](https://discord.gg/cdp)

지금 당장 x402로 수익 창출이 가능한 Farcaster 미니앱을 만들어 보세요!


import { Callout } from "vocs/components";
import FacillitatorModelCards from "../components/FacillitatorModelCards";

## 네트워크 & 토큰 지원

<Callout type="tip">
  모든 Facilitator의 완전하고 최신 디렉토리를 보려면 [**x402scan**](https://www.x402scan.com/facilitators)을 방문하세요.
</Callout>

### 개요

x402는 여러 블록체인 네트워크에서 작동하도록 설계되었으며, 사용하는 퍼실리테이터에 따라 지원 수준이 다릅니다.
프로토콜 자체는 네트워크에 구애받지 않지만, 퍼실리테이터는 결제 검증 및 정산을 위해 네트워크별 로직을 구현해야 합니다.

x402는 EVM 및 Solana 네트워크를 위한 세 가지 촉진 모델을 제공합니다.

<FacillitatorModelCards />

<Callout type="info">
  이 내용은 공식 CDP 문서에 해당합니다. 커뮤니티에서 관리되는 문서는 [**x402.gitbook.io/x402**](x402.gitbook.io/x402)에서 확인할 수 있습니다.

  도움이 필요하면 [**x402 디스코드**](https://discord.gg/cdp)에 방문해주세요.
</Callout>

### 지원하는 Facilitator

x402의 네트워크 지원은 사용하는 촉진자에 따라 달라집니다.

| **Facilitator**      | **Network Supported**          | **Production Ready** | **Requirements** |
| -------------------- | ------------------------------ | -------------------- | ---------------- |
| Community-maintained | Base and Solana (testnet only) | ❌ Testnet only       | None             |
| CDP-hosted           | Base and Solana                | ✅                    | CDP API Keys     |
| Self-hosted          | Any EVM or Solana network      | ✅                    | Additional setup |

<Callout type="info">
  All facilitators support any EIP-3009 compatible token on their supported networks.
</Callout>

#### CDP 호스팅 (권장)

CDP 호스팅 퍼실리테이터는 x402를 시작하기에 권장되는 방법입니다. 운영에 바로 사용 가능하며 동급 최고의 KYT/OFAC 규정 준수 검사를 제공합니다.

* **지원** : 베이스, 베이스 세폴리아, 솔라나, 솔라나 데브넷
* **참고** : 동급 최고의 KYT/OFAC 규정 준수 검사를 갖춘 프로덕션 지원 플랫폼입니다.
  USDC 결제는 수수료가 없습니다.
  메인넷 사용을 위해서는 CDP API 키가 필요합니다.
* **필수 사항** : [**cdp.coinbase.com**](https://cdp.coinbase.com/)의 CDP 계정 및 API 키,
  자세한 내용은 [**판매자를 위한 빠른 시작: 메인넷에서 실행**](https://docs.cdp.coinbase.com/x402/quickstart-for-sellers#running-on-mainnet)을 참조하세요 .
* **독특한 혜택** :
  * 엔터프라이즈급 규정 준수 및 보안
  * CDP 생태계와의 직접 통합
  * 우선 지원 및 SLA 제공
  * [**x402 Bazaar**](https://docs.cdp.coinbase.com/x402/bazaar) 에서 자동 서비스 검색

#### 커뮤니티 유지 촉진자

**커뮤니티 에서 관리하는 Facilitator**는 테스트 및 개발에 권장됩니다. x402 패키지의 기본 퍼실리테이터이며 별도의 설정이 필요하지 않습니다.

* **지원** : 베이스 세폴리아, 솔라나 데브넷
* **참고** : 테스트 및 개발용으로 권장됩니다. x402 패키지의 기본 지원 도구이며 별도의 설정이 필요하지 않습니다.

#### 셀프 호스팅

완벽한 제어와 맞춤 설정을 위해 자체 퍼실리테이터를 운영하세요. Avalanche, Polygon, Arbitrum 및 기타 EVM 호환 체인과 같은 네트워크를 지원합니다.

* **지원** : 모든 EVM 네트워크, Solana 네트워크
* **참고** : 완벽한 제어 및 맞춤 설정을 위해 자체 퍼실리테이터를 운영하세요. Avalanche, Polygon, Arbitrum 및 기타 EVM 호환 체인과 같은 네트워크를 지원합니다.
* **설정** : 아래의 [**새 네트워크 지원 추가**](https://docs.cdp.coinbase.com/x402/network-support#adding-support-for-new-networks)를 참조하세요.

### 토큰 지원

촉진자는 특정 토큰이 아닌 네트워크를 지원합니다.

| **Token Type**              | **Network**    | **Configuration Ready**          |
| --------------------------- | -------------- | -------------------------------- |
| USDC (default)              | EVM and Solana | Price strings (e.g., `"$0.01"`)  |
| Custom ERC-20 with EIP-3009 | EVM            | TokenAmount with EIP-712 details |
| SPL tokens                  | Solana         | No EIP-712 required              |
| Token-2022                  | Solana         | No EIP-712 required              |

:::details[사용자 정의 EIP-3009 토큰 구성]
EVM에서 사용자 지정 EIP-3009 토큰을 사용하려면 다음이 필요합니다.

1. **토큰 계약 주소**
2. **EIP-712 이름** - [**Basescan**](https://basescan.org/token/0x833589fcd6edb6e08f4c7c32d4f71b54bda02913#readProxyContract#F16) `name()` 함수 읽기
3. **EIP-712 버전** - [**Basescan**](https://basescan.org/token/0x833589fcd6edb6e08f4c7c32d4f71b54bda02913#readProxyContract#F24) `version()` 함수 읽기

구성 예:

```typescript
{
  eip712: {
    name: "USD Coin",    // From name() function
    version: "2"         // From version() function
  }
}
```

왜 EIP-3009인가요?

* 가스 없는 전송(촉진자가 가스를 후원함)
* 서명 기반 승인(오프체인 서명)
* 원스텝 결제(별도 승인 없음)
:::

:::details[Solana 토큰 세부 정보]
* **토큰 프로그램** : `TOKEN_PROGRAM_ADDRESS` (SPL), `TOKEN_2022_PROGRAM_ADDRESS` (Token-2022)
* **수수료 후원** : 중개자가 수수료를 충당하기 위해 거래를 제공하고 서명합니다 `feePayer`, `paymentRequirements.extra`
* **EIP-712 없음** : EVM과 달리 Solana 토큰에는 EIP-712 구성이 필요하지 않습니다.
:::

### 새로운 네트워크에 대한 지원 추가

x402에서 새로운 EVM 네트워크에 대한 지원을 추가하는 방법은 두 가지가 있습니다.

#### 옵션1: x402 패키지에 기여

x402 저장소에 PR을 제출하면 공식 네트워크 지원을 추가할 수 있습니다. 이렇게 하면 모든 x402 사용자가 네트워크를 사용할 수 있습니다.

##### 수정할 파일

1. `typescript/packages/x402/src/types/shared/evm/config.ts`
   네트워크의 체인 ID와 USDC 주소를 추가하세요:

```typescript
// Example: Adding Avalanche networks
"43113": {  // Avalanche Fuji testnet chain ID
usdcAddress: "0x5425890298aed601595a70AB815c96711a31Bc65",
usdcName: "USD Coin",
},
"43114": {  // Avalanche mainnet chain ID
usdcAddress: "0xB97EF9Ef8734C71904D8002F8b6Bc66Dd9c48a6E",
usdcName: "USDC",
},
```

2. `typescript/packages/x402/src/types/shared/network.ts`
   스키마와 매핑에 네트워크를 추가합니다.

```typescript
// Update the NetworkSchema enum
export const NetworkSchema = z.enum(["base-sepolia", "base", "avalanche-fuji", "avalanche"]);

// Add to SupportedEVMNetworks array
export const SupportedEVMNetworks: Network[] = [
  "base-sepolia",
  "base",
  "avalanche-fuji",
  "avalanche",
];

// Add to EvmNetworkToChainId mapping
["avalanche-fuji", 43113],
["avalanche", 43114],
```

3. `typescript/packages/x402/src/types/shared/evm/wallet.ts` - **업데이트** `getChainFromNetwork` **함수**
   `getChainFromNetwork`네트워크 문자열을 viem 체인 객체에 매핑하려면 함수 에 네트워크를 추가합니다 .

```typescript
import { avalanche, avalancheFuji } from "viem/chains";

// Add your network to the switch statement in getChainFromNetwork
case "avalanche":
return avalanche;
case "avalanche-fuji":
return avalancheFuji;
```

##### 주요 요구 사항

* **네트워크 키** : 모든 파일에서 일관된 네트워크 식별자(예: `avalanche-fuji`)를 사용합니다.
* **Viem 체인** : 네트워크는 viem/chains에서 사용 가능해야 하며 그렇지 않으면 수동으로 정의해야 합니다.
* **USDC 주소** : EIP-3009 호환 가능(`transferWithAuthorization` 함수 있음)
* **체인 ID** : 구성에서 네트워크의 공식 체인 ID를 사용하세요.
* **일관성** : 네트워크 이름이 , , 및 switch 문에서 일치 `NetworkSchema` 하는지 `SupportedEVMNetworks`확인 `EvmNetworkToChainId`합니다 `getChainFromNetwork`.

#### 옵션2: 자체 Facilitator 운영

즉각적인 지원이 필요하거나 기여하기 전에 테스트하고 싶다면 직접 Facilitator를 운영할 수 있습니다.

비디오 가이드: [**x402에 EVM 체인 추가**](https://x.com/jaycoolh/status/1920851551905575164/video/1)

##### 필수 조건

1. 대상 네트워크에 대한 RPC 엔드포인트에 액세스
2. 가스 후원을 위한 네이티브 토큰이 있는 지갑
3. x402 촉진자 코드

### 추가 네트워크 지원

현재 CDP 담당자를 통해 제공되지 않는 네트워크에 대한 지원이 필요한 경우:

1. **요청 제출** : CDP 지원팀에 문의하거나 [**x402 Discord**](https://discord.gg/cdp)에 게시하여 특정 네트워크에 대한 관심을 표현하세요.
2. **자체적인 촉진자 운영** : EVM 네트워크에 대한 즉각적인 지원을 위해 위의 자체 호스팅 가이드를 참조하세요.
3. **x402에 기여하기** : x402 패키지의 새로운 네트워크에 대한 공식 지원을 추가하기 위한 PR을 제출하세요.

CDP는 개발자의 요구에 따라 네트워크 지원을 확대하기 위해 적극적으로 노력하고 있습니다.

<Callout type="info">
  네트워크 통합에 도움이 필요하신가요?

  [**x402 Discord 커뮤니티**](https://discord.gg/cdp)에 가입 하거나 [**x402 GitHub 저장소**](https://github.com/coinbase/x402)를 확인하세요.
</Callout>

### 다음에 무엇을 읽을까요?

* [**판매자를 위한 빠른 시작**](https://docs.cdp.coinbase.com/x402/quickstart-for-sellers) : 지원되는 네트워크에서 결제 수락 시작
* [**핵심 개념**](https://docs.cdp.coinbase.com/x402/core-concepts/how-it-works) : x402가 내부적으로 어떻게 작동하는지 알아보세요
* [**Facilitator**](https://docs.cdp.coinbase.com/x402/core-concepts/facilitator) : 촉진자의 역할을 이해하세요
* [**MCP 서버**](https://docs.cdp.coinbase.com/x402/mcp-server) : x402 결제를 사용하도록 AI 에이전트 설정


## x402에 오신 것을 환영합니다

### 개요

x402는 Coinbase에 의해 개방된 새로운 개방 결제 프로토콜로서, HTTP를 통해 자동화
되고 즉각적인 스테이블 코인 결제를 가능하게 합니다.

기존에 사용하지 않던
[**HTTP 402 Payment Required**](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Status/402)
라는 HTTP 상태 코드를 이용해서, x402가 서비스를 API와 디지털 콘텐츠를 체인상에서
수익화할 수 있도록 하여, 인간과 기계 모두의 클라이언트가 계정, 세션 또는 복잡한
인증 없이 프로그래밍 방식으로 엑세스 비용을 지불할 수 있도록 합니다.

### x402는 누구를 위한 것인가요?

* **판매자:** API나 콘텐츠를 수익화하려는 서비스 제공자. x402를 사용하면 최소한의
  설정만으로 클라이언트로부터 직접 프로그래밍 방식으로 결제할 수 있습니다.
* **구매자:** 계정이나 수동 결제 흐름 없이 유료 서비스에 엑세스하려는 인간 개발
  자와 AI 에이전트.

판매자와 구매자는 모두 HTTP 요청을 통해 직접 상호 작용하며, 결제는 프로토콜을 통
해 투명하게 처리됩니다.

### 사용 사례

x402는 다음을 포함한 다양한 사용 사례를 지원합니다.

* 요청당 지불되는 API 서비스
* API 액세스 비용을 자율적으로 지불하는 AI 에이전트
* 디지털 콘텐츠에 대한 페이월
* 마이크로트랜잭션을 통해 수익화되는 마이크로서비스 및 툴링
* API 기능을 집계하고 재판매하는 프록시 서비스

### 작동 원리

x402는 프로그래매틱 결제를 통해 간단한 요청-응답 흐름을 사용합니다. 자세한 내용
은 [**x402 작동 방식**](https://naver.com)을 참조하세요.

높은 수준에서:

1. 구매자는 서버에 리소스를 요청합니다(예: API 호출,
   [**클라이언트/서버 역할**]() 참조)
2. 결제가 필요한 경우 서버는 결제 지침을 포함하여 [**402 결제 필요**]()를 응답합
   니다.
3. 구매자는 결제 페이로드를 구성하여 전송합니다.
4. [**서버는 중개자**]()를 통해 결제를 검증하고 결제합니다. 유효한 경우, 서버는
   요청된 리소스를 반환합니다.

### 기존 제한을 넘어서

x402는 현대 인터넷 경제에 맞춰 설계되었으며 기존 시스템의 주요 한계를 해결합니다
.

* **수수료와 마찰을 줄이세요:** 중개자, 높은 수수료 또는 수동 설정 없이 체인상에
  서 직접 결제하세요.
* **소액 결제 및 사용량 기반 청구:** 간단하고 프로그래밍 가능한 사용량 기반 결제
  방식으로 통화 또는 기능당 요금을 청구합니다.
* **기계 간 거래:** AI 에이전트가 키나 인간의 입력 없이 자율적으로 결제하고 서비
  스에 액세스할 수 있도록 합니다.

### 인프라를 오프로드하세요

x402 [**Facilitator**]()는 판매자가 자체 블록체인 인프라를 유지할 필요가 없도록
지불 검증 및 정산을 처리합니다.

Coinbase 개발자 플랫폼(CDP)은 Coinbase가 호스팅하는 중개 서비스를 제공하며, Base
네트워크에서 수수료 없이 USDC 결제를 처리하여 구매자와 판매자 모두에게 간소화되
고 예측 가능한 경험을 제공합니다.

* Base 네트워크에서 수수료 없는 USDC 지불
* 거래의 빠른 온체인 결제
* 판매자가 결제 수락을 시작할 수 있도록 간소화된 설정

### 촉진자 로드맵

CDP의 x402 퍼실리테이터는 특정 공급업체에 종속되지 않는 개방형 표준 기반의 퍼실
리테이터로 설계되었습니다. 향후에는 다음 퍼실리테이터가 포함됩니다.

* 구매자(인간 및 에이전트)가 사용 가능한 서비스를 찾을 수 있는 검색 계층
* 추가 결제 흐름 지원(예: 완료된 작업에 대한 지불, 신용 기반 청구 등)
* 판매자가 KYC 또는 지리적 제한을 시행하기 위한 선택적 증명
* 추가 자산 및 네트워킹 지원

목표는 프로그래밍 방식의 상거래를 접근 가능하고 허가 없이, 개발자 친화적으로 만
드는 것입니다.

### 다음에 무엇을 읽을까요?

* [**판매자를 위한 빠른 시작**]() : 클라이언트로부터 결제를 수락하여 x402를 시작
  하세요.
* [**구매자를 위한 빠른 시작**]() : 서비스 비용을 지불하여 x402를 시작하세요.
* [**네트워크 지원**]() : 이용 가능한 지원자와 지원 네트워크를 확인하세요.
* [**x402 작동 원리**]() : 전체 결제 흐름을 이해하세요.
* [**Discord 커뮤니티에 가입**]()하여 도움을 받고 최신 개발 사항을 파악하세요/


import { Callout } from "vocs/components";

## 자주 묻는 질문

<Callout type="info">
  이 내용은 공식 CDP 문서에 해당합니다. 커뮤니티에서 관리되는 문서는 [**x402.gitbook.io/x402**](x402.gitbook.io/x402)에서 확인할 수 있습니다.

  도움이 필요하면 [**x402 디스코드**](https://discord.gg/cdp)에 방문해주세요.
</Callout>

### 일반

#### x402는 한 문장으로 무엇 이죠 ?

`402 Payment Required` x402는 휴면 HTTP 상태 코드를 API, 웹사이트 및 자율 에이전트를 위한 모든 기능을 갖춘 온체인 결제 계층으로 전환하는 오픈 소스 프로토콜입니다 .

#### ​왜 기존의 결제 수단이나 API 키를 사용하지 않나요?

기존 철도 시스템은 신용카드 네트워크, 사용자 계정, 여러 단계로 구성된 UI 흐름을 필요로 합니다.
x402는 이러한 종속성을 제거하여 프로그래밍 방식의 HTTP 기반 결제(AI 에이전트에 적합)를 가능하게 하며, 수수료를 거의 0에 가깝게 낮추고 약 1초 안에 결제를 완료합니다.

#### x402는 암호화 기반 프로젝트에만 사용되나요?

아니요. 소액 거래나 사용량 기반 거래에 대해 비용이 저렴하고 원활한 결제 경로를 원하는 모든 웹 API나 콘텐츠 제공자(암호화폐 또는 웹2)가 x402를 통합할 수 있습니다.

### 언어 및 프레임워크 지원

#### 어떤 언어와 프레임워크가 지원되나요?

TypeScript와 Python(곧 출시)이 **참조 구현 이지만 x402는 개방형 프로토콜** 입니다.

Go, Rust 등으로 사양을 구현하는 데 아무런 문제가 없습니다.
좋아하는 언어에 대한 지원을 구축하는 데 관심이 있으시다면 [**이슈**](https://github.com/coinbase/x402/issues)를 열어 알려주세요.
기꺼이 도와드리겠습니다!

### Facilitator

#### 오늘날 누가 Facilitator를 운영합니까?

코인베이스 개발자 플랫폼은 최초의 프로덕션 퍼실리테이터를 운영합니다.
하지만 이 프로토콜은 **허가가 필요 없으므로** 누구나 퍼실리테이터를 운영할 수 있습니다. 다음과 같은 사항이 예상됩니다.

* 다른 네트워크나 자산을 위한 커뮤니티 운영 촉진자.
* 맞춤형 KYT/KYC 흐름이 필요한 기업을 위한 개인 중개자입니다.

#### 악의적인 조력자가 자금을 훔치거나 합의에 대해 거짓말하는 것을 막는 것은 무엇입니까?

모든 거래 `x402PaymentPayload` 는 **구매자가 서명** 하고 **체인상에서 직접** 결제됩니다 . 거래를 조작하는 중개자는 서명 확인에 실패합니다.

### 가격 및 계획

#### 엔드포인트 가격은 어떻게 책정해야 하나요?

정답은 단 하나만 있는 것이 아니지만, 일반적인 패턴은 다음과 같습니다.

* **통화당 정액** (예: `$0.001` 요청당)
* **계층형** ( 가격이 다른 엔드포인트 `/basic` 대비 `/pro`)
* **최대 지불** (진행 중): 최종 비용이 사용량(토큰, MB 등)과 동일한 "최대 지불"

#### x402를 Metronome과 같은 사용/계획 관리자와 통합할 수 있나요?

네. x402에서 **결제 실행**을 처리합니다.
메트로놈에서 사용량 측정, 통화 집계, 선불 크레딧 발급이 가능하며, 한도 초과 시에만 요금을 청구할 수 있습니다.
예시 글루 코드는 곧 출시될 예정입니다.

### 자산, 네트워크 및 수수료

#### 현재 어떤 자산과 네트워크가 지원되나요?

**CDP Facilitator는 다음을 지원합니다.**

| **Network**  | **Asset**  | **Fees\*** | **Status** |
| ------------ | ---------- | ---------- | ---------- |
| Base         | USDC       | fee-free   | Mainnet    |
| Base Sepolia | USDC       | fee-free   | Testnet    |
| Solana       | SPL Tokens | fee-free   | Mainnet    |
| Solana       | SPL Tokens | fee-free   | Testnet    |

* *가스는 체인에서 지불됩니다. CDP의 x402 중개업체는 중개업체 수수료를 전혀 추가하지 않습니다.*
* 모든 네트워크는 호환 가능한 토큰(EVM의 EIP-3009, Solana의 SPL)을 지원합니다.

#### Polygon이나 Avalanche 같은 추가 네트워크에 대한 지원이 필요합니다. 어떻게 해야 하나요?

CDP는 네트워크 지원을 적극적으로 확대하고 있습니다. 그동안:

* 자체 촉진자 실행 - x402 코드베이스는 Polygon, Avalanche 및 기타 네트워크를 지원합니다.
* CDP 지원 채널을 통해 기능 요청 제출
* 네트워크 확장에 대한 업데이트는 [**x402 Discord**](https://discord.gg/cdp)에서 확인하세요.

### 보안

#### 백엔드에 개인 키를 노출해야 합니까?

아니요. 권장되는 패턴은 다음과 같습니다.

1. **구매자** (클라이언트/에이전트)는 런타임(브라우저, 서버리스, 에이전트 VM)에서 로컬로 로그인합니다.
   [**CDP 서버 지갑**](https://docs.cdp.coinbase.com/server-wallets/v1/concepts/wallets)을 사용하여 프로그래밍 방식 지갑을 생성할 수 있습니다.
2. **판매자**는 구매자의 키를 결코 보유하지 않습니다. 단지 서명만 확인할 뿐입니다.

#### 환불은 어떻게 이루어지나요?

현재 방식은 **푸시 결제** `exact` 방식으로 , 실행 후 취소가 불가능합니다. 두 가지 옵션이 있습니다.

1. **비즈니스 로직 환불** : 판매자가 구매자에게 새로운 USDC를 다시 전송합니다.
2. **에스크로 제도** : 향후 사양에는 조건부 이전(예: HTLC 또는 송장 보류)이 추가될 수 있습니다.

### AI 에이전트의 사용

#### 에이전트는 어떻게 얼마를 지불해야 할지 알 수 있나요?

에이전트는 사람과 동일한 흐름을 따릅니다.

1. 요청을 하세요.
2. `402 JSON (accepts array)` 을 분석합니다 .
3. 적합한 요구 사항을 선택하고 x402 클라이언트 SDK를 통해 페이로드에 서명합니다.
4. 다시 시도하세요 `X-PAYMENT`.

#### 에이전트에게 지갑이 필요한가요?

네. 프로그래밍 방식 지갑(예: **CDP 서버 지갑** , HD 지갑)을 사용하면 에이전트가 시드 문구를 노출하지 않고도 페이로드에 서명할 수 `viem` 있습니다 . `ethers-v6` `EIP-712`

### 거버넌스 및 로드맵

#### 공식적인 사양이나 백서가 있나요?

* 사양: [**GitHub 사양**](https://github.com/coinbase/x402/tree/main/specs)
* [**백서**](https://www.x402.org/x402-whitepaper.pdf)

#### x402는 어떻게 진화할까요?

공개 GitHub 이슈 및 커뮤니티 RFC에서 추적되었습니다. 주요 주제:

* 다중 자산 지원
* 추가 계획 ( `upto`, `stream`, `permit2`)
* 서비스 검색 및 평판을 위한 검색 계층

#### x402가 Coinbase GitHub에 호스팅되는 이유는 무엇입니까?

현재 해당 레포는 주로 코인베이스 소유임을 인지하고 있습니다.
이는 당사의 최고 보안 및 감사팀을 활용하여 사양의 안전성을 확보하고 누구도 실수로 법적으로 모호한 결제 흐름을 생성하지 않도록 하기 위한 것입니다.
궁극적으로는 레포의 소유권을 운영 그룹이나 오픈소스 위원회로 이전할 계획입니다.

### 문제 해결

#### `402 Payment Required`을(를) 붙인 후에도 계속 입니다 `X-PAYMENT`. 왜 그럴까요?

1. 서명이 잘못되었습니다(잘못된 체인 ID 또는 페이로드 필드).
2. 결제금액 \< `maxAmountRequired`.
3. 주소에 USDC가 부족하거나 KYT에 의해 신고되었습니다. `error` 자세한 내용은 서버 JSON 응답의 필드를 확인하세요.

#### 제 테스트는 Base Sepolia에서는 작동하지만 Base 메인넷에서는 실패합니다. 무엇이 바뀌었나요?

* `network: "base"`(아님 ) 을 설정하세요 `"base-sepolia"`.
* 지갑에 `메인넷` USDC가 있는지 확인하세요.
* 메인넷에서는 가스 요금이 더 높습니다. 가스 요금으로 소액의 ETH를 지갑에 입금하세요.

### 아직 궁금한 점이 있으신가요?

* [**Discord 채널**](https://discord.gg/invite/cdp) 에서 연락하세요
* [**x402 저장소**](https://github.com/coinbase/x402) 에서 GitHub 토론 또는 이슈를 열어보세요


import { Callout } from "vocs/components";

## 구매자를 위한 빠른 시작

<Callout type="info">
  이 내용은 공식 CDP 문서에 해당합니다. 커뮤니티에서 관리되는 문서는 [**x402.gitbook.io/x402**](https://x402.gitbook.io/x402)에서 확인할 수 있습니다.

  도움이 필요하면 [**x402 디스코드**](https://discord.gg/cdp)에 방문해주세요.
</Callout>

이 가이드에서는 **x402**를 사용하여 결제가 필요한 서비스와 상호 작용하는 방법을 안내합니다.
이 가이드를 통해 프로그래밍 방식으로 결제 요건을 확인하고, 결제를 완료하고, 유료 리소스에 액세스할 수 있게 됩니다.

다양한 언어용 x402 도우미 패키지를 통해 x402를 간단하고 편리하게 이용할 수 있습니다.
최소한의 코드만으로 결제 문제를 자동으로 감지하고, 온체인에서 결제를 승인하고, 요청을 재시도할 수 있습니다.
이 패키지는 다음 흐름을 자동으로 트리거합니다.

1. Fetch를 사용하는 경우 초기 요청을 만들거나 Axios / HTTPX / Requests를 사용하는 경우 초기 요청을 인터셉트 합니다.
2. 402 응답이 수신되면 결제 요구 사항을 파싱합니다.
3. 지불 금액이 허용 최대 금액 내에 있는지 확인합니다.
4. 제공된 지갑 클라이언트를 사용하여 지불 헤더를 생성합니다.
5. 결제 헤더를 포함하여 결제 요청을 다시 시도합니다.

### 필수 조건

시작하기 전에 다음 사항을 확인하세요.

* USDC가 포함된 암호화폐 지갑(EVM 호환 지갑, 예:
  [**CDP Wallet**](https://docs.cdp.coinbase.com/server-wallets/v1/concepts/wallets),
  [**AgentKit**](https://docs.cdp.coinbase.com/agent-kit/welcome))
* [**Node.js**](https://nodejs.org/en)와 npm, 또는 python과 pip
* x402를 통한 결제가 필요한 서비스

<Callout type="info">
  저희 [**리포지토리**](https://github.com/coinbase/x402/tree/main/examples)에는
  fetch, Axios, MCP에 대한 예제를 포함하여 미리 구성된 예제가 있습니다.
</Callout>

### 1. 종속성 설치

Node.js 환경의 경우 [**x402-axios**](https://www.npmjs.com/package/x402-axios) 또는 [**x402-fetch**](https://www.npmjs.com/package/x402-fetch)를 설치하세요.

Python 환경의 경우 [**x402 패키지**](https://pypi.org/project/x402/)를 설치하세요.

:::code-group
```bash [Node.js]
npm install x402-axios
# or
npm install x402-fetch
```

```bash [Python]
pip install x402
```
:::

### 2. 지갑 클라이언트 생성

[**CDP의 서버 지갑**](https://docs.cdp.coinbase.com/server-wallets/v1/concepts/wallets)(추천) 이나
스탠드얼론 지갑 라이브러리(Node.js의 EVM용 [**viem**](https://viem.sh/),
Python의 EVM용 [**eth-account**](https://github.com/ethereum/eth-account),
Solana 지원용 [**SolanaKit**](https://www.solanakit.com/))를 사용하여 지갑 클라이언트를 만듭니다.

#### CDP 서버 지갑 (추천)

먼저 [**cdp.coinbase.com**](https://cdp.coinbase.com/) 에서 계정을 만들고 포털에서 다음 API 키를 가져와 환경 변수로 저장합니다.

```bash
# store in .env or using the command `export <name>="secret-info"`
CDP_API_KEY_ID=your-api-key-id
CDP_API_KEY_SECRET=your-api-key-secret
CDP_WALLET_SECRET=your-wallet-secret
```

그런 다음 필요한 패키지를 설치하세요.

:::code-group
```bash [Node.js]
npm install @coinbase/cdp-sdk dotenv
```

```bash [Python]
pip install cdp python-dotenv
```
:::

마지막으로, [**Server Wallet Quickstart**](https://docs.cdp.coinbase.com/server-wallets/v2/introduction/quickstart) 에서 제안한 대로 CDP 클라이언트를 인스턴스화합니다.

#### 스탠드얼론 지갑 라이브러리

자체 지갑을 사용하려면 스탠드얼론 지갑 라이브러리를 사용할 수 있습니다.

##### EVM

필요한 패키지를 설치하세요:

:::code-group
```bash [Node.js (viem)]
npm install viem
```

```bash [Python (eth-account)]
pip install eth_account
```
:::

그런 다음 지갑 계정을 인스턴스화합니다.

:::code-group
```javascript [Node.js (viem)]
import { createWalletClient, http } from "viem";
import { privateKeyToAccount } from "viem/accounts";
import { baseSepolia } from "viem/chains";

// Create a wallet client (using your private key)
const account = privateKeyToAccount("0xYourPrivateKey"); // we recommend using an environment variable for this
```

```python [Python (eth-account)]
from eth_account import Account

account = Account.from_key("your_private_key") # we recommend using an environment variable for this
```
:::

##### 솔라나(SVM)

[**SolanaKit**](https://www.solanakit.com/)을 사용하여 서명자를 인스턴스화합니다.

```javascript
import { createKeyPairSignerFromBytes } from "@solana/kit";
import { base58 } from "@scure/base";

// 64-byte base58 secret key (private + public)
const signer = await createKeyPairSignerFromBytes(
  base58.decode(process.env.SOLANA_PRIVATE_KEY!)
);
```

### 3. 자동으로 유료 요청하기

x402 도우미 패키지를 사용하면 402 결제 필요 응답을 자동으로 처리하고 결제 흐름을 완료할 수 있습니다.

**Node.js** :

`x402-fetch` 와 `x402-axios` 중 하나를 사용할 수 있습니다.

**x402-fetch**는 네이티브 `fetch` API를 확장하여 402 응답과 결제 헤더를 자동으로 처리합니다.
전체 예시는 [**여기**](https://github.com/coinbase/x402/tree/main/examples/typescript/clients/fetch)에서 확인하세요.

**x402-axios**는 Axios에 결제 인터셉터를 추가하여 결제 헤더를 사용하여 요청을 자동으로 재시도합니다.
전체 예시는 [**여기**](https://github.com/coinbase/x402/tree/main/examples/typescript/clients/axios)에서 확인하세요.

**Python** :

`httpx` 와 `Requests` 중 하나를 사용할 수 있습니다.

* **Requests**는 **동기식** HTTP 요청을 위한 잘 설계된 라이브러리입니다. 간단하고 순차적인 워크플로에 적합합니다.
* **HTTPX** 는 **동기** 및 **비동기** HTTP 요청을 모두 지원하는 최신 라이브러리입니다. 높은 동시성이나 비동기 기능이 필요할 때 사용할 수 있습니다.

두 방식 모두 **간단** 하고 **확장 가능한** 접근 방식을 지원합니다. 간단한 접근 방식(아래 참조)은 결제를 자동으로 처리하는 미리 구성된 클라이언트를 반환합니다.

:::code-group
```javascript [x402-fetch]
import { wrapFetchWithPayment, decodeXPaymentResponse } from "x402-fetch";

const fetchWithPayment = wrapFetchWithPayment(fetch, account);

fetchWithPayment(url, { //url should be something like https://api.example.com/paid-endpoint
method: "GET",
})
.then(async response => {
    const body = await response.json();
    console.log(body);

    const paymentResponse = decodeXPaymentResponse(response.headers.get("x-payment-response")!);
    console.log(paymentResponse);
})
.catch(error => {
    console.error(error.response?.data?.error);
});
```

```javascript [x402-axios]
import { withPaymentInterceptor, decodeXPaymentResponse } from "x402-axios";
import axios from "axios";

// Create an Axios instance with payment handling
const api = withPaymentInterceptor(
  axios.create({
    baseURL, // e.g. https://api.example.com
  }),
  account
);

api
  .get(endpointPath) // e.g. /paid-endpoint
  .then((response) => {
    console.log(response.data);

    const paymentResponse = decodeXPaymentResponse(
      response.headers["x-payment-response"]
    );
    console.log(paymentResponse);
  })
  .catch((error) => {
    console.error(error.response?.data?.error);
  });
```
:::

HTTPX 전체 예는 [**여기**](https://github.com/coinbase/x402/tree/main/examples/python/clients/httpx)를 참조하세요

Requests 전체 예는 [**여기**](https://github.com/coinbase/x402/tree/main/examples/python/clients/requests)를 참조하세요

:::code-group
```python [HTTPX]
from x402.clients.httpx import x402HttpxClient
# Other imports...

# Wallet creation logic ...

# Create client and make request
async with x402HttpxClient(account=account, base_url="https://api.example.com") as client:
    response = await client.get("/protected-endpoint")
    print(await response.aread())
```

```python [Requests]
from x402.clients.requests import x402_requests
# Other imports...

# Wallet creation logic ...

# Create session and make request
session = x402_requests(account)
response = session.get("https://api.example.com/protected-endpoint")
print(response.content)
```
:::

### 4. 사용 가능한 서비스 검색(선택 사항)

엔드포인트를 하드코딩하는 대신 x402 Bazaar를 사용하여 사용 가능한 서비스를 동적으로 검색할 수 있습니다.
이는 특히 새로운 기능을 찾아 사용할 수 있는 자율 에이전트를 구축하는 데 매우 유용합니다.
[**Python**](https://github.com/coinbase/x402/tree/main/examples/python/discovery)과
[**Node.js**](https://github.com/coinbase/x402/tree/main/examples/typescript/discovery)에 대한 전체 예제를 확인할 수 있습니다.

:::code-group
```javascript [Node.js]
import { useFacilitator } from "x402/verify";
import { facilitator } from "@coinbase/x402";

// Get the list function from the facilitator
const { list } = useFacilitator(facilitator);

// Discover all available x402 services
const services = await list();
```

```python [Python]
from x402.facilitator import FacilitatorClient
from cdp.x402 import create_facilitator_config

# Set up facilitator client
facilitator_config = create_facilitator_config()
facilitator = FacilitatorClient(facilitator_config)

# Discover all available x402 services
services = await facilitator.list()
```
:::

<Callout type="info">
  서비스 필터링 방법, 스키마 이해 방법, 새로운 기능을 자율적으로 검색할 수 있는
  에이전트 구축 방법 등 [**x402 Bazaar
  문서**](https://docs.cdp.coinbase.com/x402/bazaar) 에서 서비스 검색에 대해
  자세히 알아보세요 .
</Callout>

### 5. 오류 처리

클라이언트는 다음과 같은 경우 오류가 발생합니다.

* 요청 구성 누락
* 해당 요청에 대한 지불이 이미 시도됨
* 결제 헤더를 생성하는 중 오류가 발생

### 요약

* x402 클라이언트 패키지 설치
* 지갑 클라이언트 생성
* 제공된 wrapper/interceptor를 사용하여 유료 API 요청 만들기
* (선택 사항) x402 Bazaar를 사용하여 서비스를 동적으로 검색하기
* 결제 자체는 이러한 과정을 통해 자동으로 처리됨

### 참고문헌:

* [**x402-fetch npm 문서**](https://www.npmjs.com/package/x402-fetch)
* [**x402-axios npm 문서**](https://www.npmjs.com/package/x402-axios)
* [**x402 PyPi 페이지**](https://pypi.org/project/x402/)
* [**x402 Bazaar 문서**](https://docs.cdp.coinbase.com/x402/bazaar) - 사용 가능한 서비스 검색

질문이나 지원이 필요하면 [**디스코드**](https://discord.gg/invite/cdp)에 방문하세요.


import { Callout } from "vocs/components";

## 판매자를 위한 빠른 시작

이 가이드에서는 x402와 통합하여 API 또는 서비스에 대한 결제를 활성화하는 방법을 안내합니다.
가이드를 완료하면 API에서 구매자와 AI 에이전트에게 액세스 요금을 청구할 수 있게 됩니다.

<Callout type="note">
  이 빠른 시작은 안전한 테스트를 위한 테스트넷 구성부터 시작합니다.
  프로덕션 준비가 되면 Base(EVM) 및 Solana 네트워크에서 실제 결제를 수락하는 데 필요한 간단한 변경 사항은
  [**"메인넷에서 실행"**](https://docs.cdp.coinbase.com/x402/quickstart-for-sellers#running-on-mainnet)을 참조하세요.
</Callout>

<Callout type="info">
  이 내용은 공식 CDP 문서에 해당합니다. 커뮤니티에서 관리되는 문서는 [**x402.gitbook.io/x402**](x402.gitbook.io/x402)에서 확인할 수 있습니다.

  도움이 필요하면 [**x402 디스코드**](https://discord.gg/cdp)에 방문해주세요.
</Callout>

### 필수 조건

시작하기 전에 다음 사항을 확인하세요.

* USDC가 포함된 암호화폐 지갑(EVM 호환 지갑, 예:
  [**CDP Wallet**](https://docs.cdp.coinbase.com/server-wallets/v1/concepts/wallets),
  [**AgentKit**](https://docs.cdp.coinbase.com/agent-kit/welcome))
* [**Node.js**](https://nodejs.org/en)와 npm, 또는 python과 pip
* x402를 통한 결제가 필요한 서비스

<Callout type="info">
  저희 [**저장소**](https://github.com/coinbase/x402/tree/main/examples)에는
  fetch, Axios, MCP에 대한 예제를 포함하여 미리 구성된 예제가 있습니다.
</Callout>

### 1. 종속성 설치

[**x402 Express**](https://www.npmjs.com/package/x402-express) 미들웨어 패키지를 설치하세요

[**x402 Next.js**](https://www.npmjs.com/package/x402-next) 미들웨어 패키지를 설치하세요

[**x402 Hono**](https://www.npmjs.com/package/x402-hono) 미들웨어 패키지를 설치하세요

:::code-group
```bash [Node.js (Express)]
npm install x402-express
npm install @coinbase/x402 # for the mainnet facilitator
```

```bash [Node.js (Next.js)]
npm install x402-next
npm install @coinbase/x402 # for the mainnet facilitator
```

```bash [Node.js (Hono)]
npm install x402-hono
npm install @coinbase/x402 # for the mainnet facilitator
```
:::

[**x402 Python 패키지**](https://pypi.org/project/x402/)를 설치하세요

```bash
pip install x402
pip install cdp # for the mainnet facilitator
```

<Callout type="note">
  메인넷 퍼실리테이터 패키지( `@coinbase/x402` Node.js, `cdp` Python용)는 프로덕션 환경에만 필요합니다.
  테스트넷 개발 시에는 이 패키지를 건너뛸 수 있습니다.
  자세한 내용은 [**메인넷 실행**](https://docs.cdp.coinbase.com/x402/quickstart-for-sellers#running-on-mainnet)을 참조하세요.
</Callout>

### 2. 결제 미들웨어 추가

결제 미들웨어를 애플리케이션에 통합하세요. 다음 사항을 제공해야 합니다.

* Facilitator URL 또는 facilitator 객체입니다. 테스트용으로는 `https://x402.org/facilitator` Base Sepolia와 Solana Devnet에서 작동하는 기능을 사용하세요.
  * 메인넷 설정에 대해서는 [메인넷에서 실행](https://docs.cdp.coinbase.com/x402/quickstart-for-sellers#running-on-mainnet)을 참조하세요.
* 보호하려는 경로
* 수신 지갑 주소

<Callout type="tip">
  아래 예시는 테스트넷 구성을 보여줍니다.
  실제 결제를 받을 준비가 되면 [**"메인넷에서 실행"**](https://docs.cdp.coinbase.com/x402/quickstart-for-sellers#running-on-mainnet) 을 참조하여
  필요한 간단한 변경 사항을 확인하세요.
</Callout>

전체 예는 여기 [**저장소**](https://github.com/coinbase/x402/tree/main/examples/typescript/servers/express)에서 확인 할 수 있습니다.

:::code-group
```javascript [Node.js (Express)]
import express from "express";
import { paymentMiddleware, Network } from "x402-express";
// import { facilitator } from "@coinbase/x402"; // For mainnet

const app = express();

app.use(
  paymentMiddleware(
    "0xYourAddress", // your receiving wallet address
    {
      // Route configurations for protected endpoints
      "GET /weather": {
        // USDC amount in dollars
        price: "$0.001",
        network: "base-sepolia", // for mainnet, see Running on Mainnet section
        // Optional: Add metadata for better discovery in x402 Bazaar
        config: {
          description: "Get current weather data for any location",
          inputSchema: {
            type: "object",
            properties: {
              location: { type: "string", description: "City name" },
            },
          },
          outputSchema: {
            type: "object",
            properties: {
              weather: { type: "string" },
              temperature: { type: "number" },
            },
          },
        },
      },
    },
    {
      url: "https://x402.org/facilitator", // for testnet
    }
  )
);

// Implement your route
app.get("/weather", (req, res) => {
  res.send({
    report: {
      weather: "sunny",
      temperature: 70,
    },
  });
});

app.listen(4021, () => {
  console.log(`Server listening at http://localhost:4021`);
});
```

```javascript [Node.js (Next.js)]
import { paymentMiddleware, Network } from "x402-next";
// import { facilitator } from "@coinbase/x402"; // For mainnet

// Configure the payment middleware
export const middleware = paymentMiddleware(
  "0xYourAddress", // your receiving wallet address
  {
    // Route configurations for protected endpoints
    "/protected": {
      price: "$0.01",
      network: "base-sepolia", // for mainnet, see Running on Mainnet section
      config: {
        description: "Access to protected content",
        // Optional: Add schemas for better discovery
        inputSchema: {
          type: "object",
          properties: {},
        },
        outputSchema: {
          type: "object",
          properties: {
            content: { type: "string" },
          },
        },
      },
    },
  },
  {
    url: "https://x402.org/facilitator", // for testnet
  }
);

// Configure which paths the middleware should run on
export const config = {
  matcher: ["/protected/:path*"],
};
```

```javascript [Node.js (Hono)]
import { Hono } from "hono";
import { serve } from "@hono/node-server";
import { paymentMiddleware, Network } from "x402-hono";
// import { facilitator } from "@coinbase/x402"; // For mainnet

const app = new Hono();

// Configure the payment middleware
app.use(
  paymentMiddleware(
    "0xYourAddress", // your receiving wallet address
    {
      // Route configurations for protected endpoints
      "/protected-route": {
        price: "$0.10",
        network: "base-sepolia", // for mainnet, see Running on Mainnet section
        config: {
          description: "Access to premium content",
        },
      },
    },
    {
      url: "https://x402.org/facilitator", // for testnet
    }
  )
);

// Implement your route
app.get("/protected-route", (c) => {
  return c.json({ message: "This content is behind a paywall" });
});

serve({
  fetch: app.fetch,
  port: 3000,
});
```
:::

:::code-group
```python [Python (FastAPI)]
import os
from typing import Any, Dict
from dotenv import load_dotenv
from fastapi import FastAPI
from x402.fastapi.middleware import require_payment
from x402.types import EIP712Domain, TokenAmount, TokenAsset

# Load environment variables
load_dotenv()

app = FastAPI()

# Apply payment middleware to specific routes
app.middleware("http")(
    require_payment(
        path="/weather",
        price="$0.001",
        pay_to_address="0xYourAddress",
        network_id="base-sepolia", # for mainnet, see Running on Mainnet section
        # Optional: Add metadata for better discovery in x402 Bazaar
        description="Get current weather data for any location",
        input_schema={
            "type": "object",
            "properties": {
                "location": {"type": "string", "description": "City name"}
            }
        },
        output_schema={
            "type": "object",
            "properties": {
                "weather": {"type": "string"},
                "temperature": {"type": "number"}
            }
        }
    )
)

@app.get("/weather")
async def get_weather() -> Dict[str, Any]:
    return {
        "report": {
            "weather": "sunny",
            "temperature": 70,
        }
    }
```

```python [Python (Flask)]
import os
from flask import Flask, jsonify
from dotenv import load_dotenv
from x402.flask.middleware import PaymentMiddleware
from x402.types import EIP712Domain, TokenAmount, TokenAsset

# Load environment variables
load_dotenv()

app = Flask(__name__)

# Initialize payment middleware
payment_middleware = PaymentMiddleware(app)

# Apply payment middleware to specific routes
payment_middleware.add(
    path="/weather",
    price="$0.001",
    pay_to_address="0xYourAddress",
    network="base-sepolia", # for mainnet, see Running on Mainnet section
    # Optional: Add metadata for better discovery in x402 Bazaar
    description="Get current weather data for any location",
    input_schema={
        "type": "object",
        "properties": {
            "location": {"type": "string", "description": "City name"}
        }
    },
    output_schema={
        "type": "object",
        "properties": {
            "weather": {"type": "string"},
            "temperature": {"type": "number"}
        }
    }
)

@app.route("/weather")
def get_weather():
    return jsonify({
        "report": {
            "weather": "sunny",
            "temperature": 70,
        }
    })
```
:::

<Callout type="note">
  실제 결제를 받을 준비가 되셨나요?
  프로덕션 설정을 위해 [**메인넷에서 실행**](https://docs.cdp.coinbase.com/x402/quickstart-for-sellers#running-on-mainnet)을 참조하세요.
</Callout>

**결제 미들웨어 구성 인터페이스**:

```typescript
interface PaymentMiddlewareConfig {
  description?: string; // Description of the payment
  mimeType?: string; // MIME type of the resource
  maxTimeoutSeconds?: number; // Maximum time for payment (default: 60)
  outputSchema?: Record; // JSON schema for the response
  customPaywallHtml?: string; // Custom HTML for the paywall
  resource?: string; // Resource URL (defaults to request URL)
}
```

이러한 경로에 대한 요청이 지불 없이 이루어지면 서버는 HTTP 402 지불 필요 코드와 지불 지침으로 응답합니다.

### 3. 통합 테스트

확인하려면:

1. 엔드포인트(예: )에 요청을 합니다 `curl http://localhost:3000/your-endpoint`.
2. 서버는 본문에 결제 지침을 포함하여 402 결제 필요를 응답합니다.
3. 호환되는 클라이언트, 지갑 또는 자동화된 에이전트를 사용하여 결제를 완료하세요.
   일반적으로 결제 페이로드에 서명하는 과정이 포함되며,
   이는 [**구매자를 위한 빠른 시작**](https://docs.cdp.coinbase.com/x402/quickstart-for-buyers) 에 자세히 설명된 클라이언트 SDK에서 처리됩니다.
4. 이번에는 `X-PAYMENT` 암호화된 지불 증명(지불 페이로드)이 포함된 헤더를 포함하여 요청을 다시 시도합니다.
5. 서버는 중개자를 통해 결제를 확인하고, 유효한 경우 실제 API 응답(예: `{ "data": "Your paid API response." }`)을 반환합니다.

### 4. 메타데이터를 사용하여 검색 기능 향상 (권장)

CDP 퍼실리테이터를 사용하면 구매자와 AI 에이전트가 서비스를 찾을 수 있도록 돕는 검색 레이어인 x402 Bazaar 에 엔드포인트가 자동으로 나열 됩니다.
가시성을 높이고 사용자가 API를 쉽게 이해할 수 있도록 다음 단계를 따르세요.

<Callout type="tip">
  미들웨어 구성에 **설명적 메타데이터**를 포함합니다 .

  * `description`: 엔드포인트가 무엇을 하는지에 대한 명확한 설명
  * `inputSchema`: 필수 매개변수를 설명하는 JSON 스키마
  * `outputSchema`: 응답 형식의 JSON 스키마

  이 메타데이터는 다음에 도움이 됩니다.

  * AI 에이전트는 API 사용 방법을 자동으로 이해합니다.
  * 개발자는 자신의 요구 사항을 충족하는 서비스를 빠르게 찾을 수 있습니다.
  * 검색 결과에서 순위를 개선하세요
</Callout>

전체 메타데이터가 포함된 예:

```json
{
  "price": "$0.001",
  "network": "base",
  "config": {
    "description": "Get real-time weather data including temperature, conditions, and humidity",
    "inputSchema": {
      "type": "object",
      "properties": {
        "location": {
          "type": "string",
          "description": "City name or coordinates (e.g., 'San Francisco' or '37.7749,-122.4194')"
        },
        "units": {
          "type": "string",
          "enum": ["celsius", "fahrenheit"],
          "default": "fahrenheit"
        }
      },
      "required": ["location"]
    },
    "outputSchema": {
      "type": "object",
      "properties": {
        "temperature": {
          "type": "number",
          "description": "Current temperature"
        },
        "conditions": {
          "type": "string",
          "description": "Weather conditions (sunny, cloudy, rainy, etc.)"
        },
        "humidity": { "type": "number", "description": "Humidity percentage" }
      }
    }
  }
}
```

[**x402 Bazaar 문서**](https://docs.cdp.coinbase.com/x402/bazaar)에서 검색 계층에 대해 자세히 알아보세요 .

### 5. 오류 처리

문제가 발생하면 [**저장소**](https://github.com/coinbase/x402/tree/main/examples)의 예제를 확인하여 더 자세한 정보와 전체 코드를 확인하세요.

`npm install` 각 예제의 종속성

### 메인넷에서 실행

테스트넷에서 통합을 테스트한 후 메인넷에서 실제 결제를 수락할 준비가 되었습니다.

#### 프로덕션을 위한 CDP Facilitator 설정

CDP의 중개자는 규정 준수 기능을 갖춘 엔터프라이즈급 결제 처리를 제공합니다.

<iframe width="560" height="315" src="https://www.youtube.com/embed/Zc_wBlDY2Zc" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen />

#### 1. CDP API 키 설정

메인넷 지원 서비스를 이용하려면 Coinbase 개발자 플랫폼 계정이 필요합니다.

1. cdp.coinbase.com 에서 가입하세요
2. 새 프로젝트를 만듭니다
3. API 자격 증명 생성
4. 다음 환경 변수를 설정하세요

```bash
CDP_API_KEY_ID=your-api-key-id
CDP_API_KEY_SECRET=your-api-key-secret
```

#### 2. 코드 업데이트

테스트넷 구성을 메인넷 설정으로 바꾸세요:

:::code-group
```javascript [Node.js]
// Change your imports
import { facilitator } from "@coinbase/x402";

// Update the middleware configuration
app.use(
  paymentMiddleware(
    "0xYourAddress",
    {
      "GET /weather": {
        price: "$0.001",
        network: "base",
      },
    },
    facilitator // this was previously { url: "https://x402.org/facilitator" }
  )
);

// or for Next.js with Solana
export const middleware = paymentMiddleware(
  "YourSolanaWalletAddress", // Use your Solana wallet address
  {
    "GET /weather": {
      price: "$0.001",
      network: "solana",
    },
  },
  facilitator // this was previously { url: "https://x402.org/facilitator" }
);
```

```python [Python]
from cdp.x402 import create_facilitator_config

facilitator_config = create_facilitator_config(
    api_key_id=CDP_API_KEY_ID,
    api_key_secret=CDP_API_KEY_SECRET,
)

# Update the middleware configuration (FastAPI)
app.middleware("http")(
    require_payment(
        path="/weather",
        price="$0.001",
        pay_to_address="0xYourAddress",
        network_id="base", # Changed from "base-sepolia"
        facilitator_config=facilitator_config,
    )
)

# Or for Flask:
payment_middleware.add(
    path="/weather",
    price="$0.001",
    pay_to_address="0xYourAddress",
    network="base", # Changed from "base-sepolia"
    facilitator_config=facilitator_config,
)
```
:::

#### 3. 지갑 업데이트

지불을 받으려는 수신 지갑 주소(`0xYourAddressUSDC`)가 실제 메인넷 주소인지 확인하세요 .

#### 4. 실제 결제로 테스트

라이브 방송을 시작하기 전에:

1. 먼저 소량으로 테스트하세요
2. 지갑에 결제가 도착하는지 확인하세요
3. 문제가 있는지 촉진자를 모니터링합니다.

<Callout type="warning">
  메인넷 거래에는 실제 돈이 사용됩니다. 테스트넷에서 먼저 철저하게 테스트하고, 메인넷에서는 소액으로 시작하세요.
</Callout>

#### 5. 다양한 네트워크 사용

CDP facilitator는 여러 네트워크를 지원합니다. 네트워크 매개변수를 변경하기만 하면 됩니다.

:::code-group
```javascript [Base Network]
// Node.js/Express
app.use(
  paymentMiddleware(
    "0xYourAddress",
    {
      "GET /weather": {
        price: "$0.001",
        network: "base",
      },
    },
    facilitator
  )
);

// Next.js
export const middleware = paymentMiddleware(
  "0xYourAddress",
  {
    "GET /weather": {
      price: "$0.001",
      network: "base",
    },
  },
  facilitator
);
```

```javascript [Solana Network]
// Node.js/Express
app.use(
  paymentMiddleware(
    "YourSolanaWalletAddress", // Use your Solana wallet address
    {
      "GET /weather": {
        price: "$0.001",
        network: "solana",
      },
    },
    facilitator
  )
);

// Next.js
export const middleware = paymentMiddleware(
  "YourSolanaWalletAddress", // Use your Solana wallet address
  {
    "GET /weather": {
      price: "$0.001",
      network: "solana",
    },
  },
  facilitator
);
```

```python [Python Examples]
# FastAPI with Solana
app.middleware("http")(
    require_payment(
        path="/weather",
        price="$0.001",
        pay_to_address="YourSolanaWalletAddress",
        network_id="solana",
        facilitator_config=facilitator_config,
    )
)

# Flask with Solana
payment_middleware.add(
    path="/weather",
    price="$0.001",
    pay_to_address="YourSolanaWalletAddress",
    network="solana",
    facilitator_config=facilitator_config,
)
```

```javascript [Testnet Networks]
// For testing on Base Sepolia
network: "base-sepolia";

// For testing on Solana Devnet
network: "solana-devnet";
```
:::

<Callout type="info">
  Polygon이나 Avalanche와 같은 추가 네트워크에 대한 지원이 필요하신가요?
  직접 퍼실리테이터를 운영하거나 CDP 지원팀에 문의하여 새로운 네트워크 추가를 요청하실 수 있습니다.
</Callout>

### 다음 단계

* 좀 더 고급 기능을 원하시나요? [**고급 예제**](https://github.com/coinbase/x402/tree/main/examples/typescript/servers/advanced)를 확인해 보세요.
* [**구매자**](https://docs.cdp.coinbase.com/x402/quickstart-for-buyers)로 시작하기

질문이나 지원이 필요하면 [**디스코드**](https://discord.gg/invite/cdp)에 방문하세요.

### 요약

이 빠른 시작에서는 다음 내용을 다루었습니다.

* x402 SDK 및 관련 미들웨어 설치
* API에 결제 미들웨어 추가 및 구성
* 통합 테스트

이제 귀하의 API는 x402를 통해 암호화폐 결제를 수락할 준비가 되었습니다.


import { Callout } from "vocs/components";

## x402 Bazaar (Discovery Layer)

x402 Bazaar는 x402 생태계의 검색 계층으로, 개발자와 AI 에이전트가 x402 호환 API 엔드포인트를 찾고 통합할 수 있도록 지원하는 기계 판독 가능 카탈로그입니다.
유료 API 검색 인덱스라고 생각하면 되며, 서비스의 자율적인 검색 및 사용을 지원합니다.

<Callout type="note">
  x402 Bazaar는 초기 개발 단계에 있습니다.
  저희의 비전은 "에이전트 엔드포인트를 위한 Google"을 구축하는 것이지만,
  현재는 "Yahoo 검색"과 같이 기능적이지만 끊임없이 진화하는 단계에 있습니다.
  피드백을 수집하고 기능을 확장함에 따라 기능과 API가 변경될 수 있습니다.
</Callout>

### 개요

Bazaar는 x402 생태계의 중요한 문제인 검색 가능성(discoverability)을 해결합니다.
검색 가능성이 없다면 x402 호환 엔드포인트는 마치 거대한 시장 속 숨겨진 가판대와 같습니다. Bazaar는 다음과 같은 기능을 제공합니다.

* **구매자(API 소비자)를 위해** : 사용 가능한 x402 지원 서비스를 프로그래밍 방식으로 검색하고 해당 기능, 가격 및 스키마를 파악합니다.
* **판매자(API 공급자)를 위한** : 개발자 및 AI 에이전트의 글로벌 대상에게 x402 지원 서비스에 대한 자동 가시성 제공
* **AI 에이전트의 경우** : 사전 통합 없이 동적 서비스 검색 - 쿼리, 찾기, 지불 및 사용

### 작동 원리

Bazaar는 현재 `/list` CDP 퍼실리테이터에 등록된 모든 x402 호환 서비스를 반환하는 간단한 엔드포인트를 제공합니다.
API가 x402 결제에 최신 버전의 CDP 퍼실리테이터를 사용하는 경우,
입력 스키마에서 discoverable 플래그를 true로 설정하면 Bazaar에서 해당 서비스가 수집됩니다
([**판매자를 위한 빠른 시작**](https://docs.cdp.coinbase.com/x402/bazaar#quickstart-for-sellers) 참조).

#### 기본 흐름

1. **발견** : 클라이언트는 `/list` 엔드포인트를 쿼리하여 사용 가능한 서비스를 찾습니다.
2. **선택** : 가격, 기능, 요구 사항을 기반으로 서비스를 선택하세요
3. **실행** : x402를 사용하여 선택한 서비스에 대한 비용을 지불하고 액세스합니다.
4. **수동 설정 없음** : API 키 없음, 계정 생성 없음, 검색 및 결제만 가능

### API 참조

#### 목록 엔드포인트

사용 가능한 모든 x402 호환 엔드포인트를 검색합니다.

```shell
GET https://api.cdp.coinbase.com/platform/v2/x402/discovery/resources
```

참고: 이 엔드포인트 사용할 때 권장되는 방법은 [**아래**](https://docs.cdp.coinbase.com/x402/bazaar#quickstart-for-buyers)에 설명된 대로 `useFacilitator` 훅을 사용하는 것입니다.

##### 응답 스키마

목록의 각 엔드포인트에는 다음 필드가 포함되어 있습니다.

```json
{
    "accepts": [
        {
            "asset": "0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913", // ERC-20 token contract address accepted for payment (here, USDC on Base)
            "description": "", // Optional description of the accepted payment
            "extra": {
            "name": "USD Coin", // Human-readable name of the asset
            "version": "2" // Version of the asset, if applicable
            },
            "maxAmountRequired": "200", // Maximum amount (in atomic units, e.g USDC has 6 decimals) required for the service
            "maxTimeoutSeconds": 60, // Maximum time (in seconds) the service will wait for payment before expiring
            "mimeType": "", // Expected MIME type for the response (optional/empty if not specified)
            "network": "base", // network where payment is accepted (e.g., 'base' for Base L2)
            "outputSchema": {
            "input": {
                "method": "GET", // HTTP method to use when calling the resource
                "type": "http" // Type of resource (e.g., 'http' endpoint)
            },
            "output": null // Output schema (null if not specified)
            },
            "payTo": "0xa2477E16dCB42E2AD80f03FE97D7F1a1646cd1c0", // Address to which payment should be sent
            "resource": "https://api.example.com/x402/last_sold", // The actual API endpoint/resource URL
            "scheme": "exact" // Payment scheme (e.g., 'exact' means exact amount required)
        }
    ],
    "lastUpdated": "2025-08-09T01:07:04.005Z",
    "metadata": {}, // Additional metadata about the service (empty object if none)
    "resource": "https://api.prixe.io/x402/last_sold", // The main resource URL for this service
    "type": "http",
    "x402Version": 1 // Version of the x402 protocol supported
},
```

### 구매자를 위한 빠른 시작

[**Python**](https://github.com/coinbase/x402/tree/main/examples/python/discovery)과
[**Node.js**](https://github.com/coinbase/x402/tree/main/examples/typescript/discovery)
에 대한 전체 예제는 각각의 링크에서 확인하세요 .

#### 1단계: 사용 가능한 서비스 찾기

퍼실리테이터 클라이언트를 사용하여 사용 가능한 x402 서비스 목록을 가져옵니다.

:::code-group
```javascript [Node.js]
import { useFacilitator } from "x402/verify";
import { facilitator } from "@coinbase/x402";

// Get the list function from the facilitator
const { list } = useFacilitator(facilitator);

// Fetch all available services
const services = await list();

// NOTE: in an MCP context, you can see the full list then decide which service to use

// Find services under $0.10
const usdcAsset = "0x036CbD53842c5426634e7929541eC2318f3dCF7e";
const maxPrice = 100000;

const affordableServices = services.items.filter((item) =>
  item.accepts.find(
    (paymentRequirements) =>
      paymentRequirements.asset == usdcAsset &&
      Number(paymentRequirements.maxAmountRequired) < maxPrice
  )
);
```

```python [Python]
from x402.facilitator import FacilitatorClient, FacilitatorConfig
from cdp.x402 import create_facilitator_config

# Set up facilitator client
facilitator_config = create_facilitator_config()
facilitator = FacilitatorClient(facilitator_config)

# Fetch all available services
services = await facilitator.list()

# NOTE: in an MCP context, you can see the full list then decide which service to use

# Find services under $0.10
usdc_asset = "0x036CbD53842c5426634e7929541eC2318f3dCF7e"
max_price = 100000

affordable_services = [
  item
  for item in services.items
  if any(
    payment_req.asset == usdc_asset
    and int(payment_req.max_amount_required) < max_price
    for payment_req in item.accepts
   )
  ]
```
:::

#### 2단계: 검색된 서비스 호출

적합한 서비스를 찾았으면 x402 클라이언트를 사용하여 호출하세요.

:::code-group
```javascript [Node.js]
import { withPaymentInterceptor } from "x402-axios";
import axios from "axios";
import { privateKeyToAccount } from "viem/accounts";

// Set up your payment account
const account = privateKeyToAccount("0xYourPrivateKey");

// Select a service from discovery
const selectedService = affordableServices[0];

// Create a payment-enabled client for that service
const client = withPaymentInterceptor(
  axios.create({ baseURL: selectedService.endpoint }),
  account
);

// Select the payment method of your choice
const selectedPaymentRequirements = selectedService.accepts[0];
const inputSchema = selectedPaymentRequirements.outputSchema.input;

// Build the request using the service's schema
const response = await client.request({
  method: inputSchema.method,
  url: inputSchema.resource,
  params: { location: "San Francisco" }, // Based on inputSchema
});

console.log("Response data:", response.data);
```

```python [Python]
from x402.client import X402Client
from eth_account import Account

# Set up your payment account
account = Account.from_key('0xYourPrivateKey')
client = X402Client(account)

# Select a service from discovery
selected_service = affordable_services[0]

# Select the payment method of your choice
selected_payment_requirements = selected_service.accepts[0]
input_schema = selected_payment_requirements.output_schema.input

# Make the request
response = client.request({
    method=input_schema.method,
    url=input_schema.resource,
    params={ "location": "San Francisco" } # Based on input_schema
})

print(f"Response data: {response}")
```
:::

### 판매자를 위한 빠른 시작

#### 검색 가능한 플래그가 있는 자동 목록

API가 x402 결제를 위한 최신 버전의 CDP 퍼실리테이터를 사용하는 경우, 입력 스키마에서 검색 가능 플래그를 true로 설정하면 Bazaar에서 수집됩니다(아래 참조).

#### 메타데이터 추가

설명과 스키마를 추가하여 목록을 더욱 풍성하게 만들려면 x402 미들웨어를 설정할 때 포함하세요. AI 에이전트가 엔드포인트를 호출하는 방식을 명확하게 알 수 있도록 각 매개변수에 대한 설명을 포함해야 합니다.

:::code-group
```javascript [Node.js]
// Next.js / Express / Hono
import { paymentMiddleware, Network } from "x402-express"; // or x402-next or x402-hono

app.use(
  paymentMiddleware({
    routes: {
      "/api/weather": {
        price: "$0.001",
        network: "base",
        config: {
          discoverable: true, // make your endpoint discoverable
          description: "Get current weather data for any location",
          inputSchema: {
            queryParams: {
              location: {
                type: string,
                description: "City name or coordinates",
                required: true,
              },
            },
          },
          outputSchema: {
            type: "object",
            properties: {
              temperature: { type: "number" },
              conditions: { type: "string" },
              humidity: { type: "number" },
            },
          },
        },
      },
    },
  })
);
```

```python [Python]
# FastAPI / Flask
from x402 import require_payment

app.middleware("http")(
    require_payment(
        path="/weather",
        price="$0.001",
        pay_to_address=WALLET_ADDRESS,
        network="base",
        description="Get current weather data for any location",
        discoverable=true, # make your endpoint discoverable <----
        input_schema={
            "queryParams": {
                "location": {
                    "type": string,
                    "description": "City name or coordinates",
                    "required": true
                }
            }
        },
        output_schema={
            "type": "object",
            "properties": {
                "temperature": {"type": "number"},
                "conditions": {"type": "string"},
                "humidity": {"type": "number"}
            }
        }
    )
)
```
:::

### 곧 출시 예정

x402 Bazaar는 빠르게 발전하고 있으며, 여러분의 피드백은 기능의 우선순위를 정하는 데 도움이 됩니다.

### 지원

* **GitHub** : [**github.com/coinbase/x402**](https://github.com/coinbase/x402)
* **Discord** : [**#x402 채널**](https://discord.com/invite/cdp)에 참여하세요
* **문서** : [**x402 개요**](https://docs.cdp.coinbase.com/x402/welcome)

### FAQ

**질문: 서비스를 등록하려면 어떻게 해야 하나요?** 답변: CDP 퍼실리테이터를 사용하는 경우, 검색 가능 플래그를 추가하면 서비스가 등록됩니다.

**질문: 엔드포인트 호출을 더 정확하게 하려면 어떻게 해야 하나요?** 답변: 각 매개변수의 기능과 엔드포인트 호출 방법을 명확하게 설명하는 설명을 포함하되, 최대한 간결하게 작성하세요.

**질문: 바자에서 탈퇴할 수 있나요?** 답변: 곧 상품 등록 환경 설정을 관리할 수 있게 됩니다.

**질문: 가격은 어떻게 책정되나요?** 답변: 등록은 무료입니다. 서비스는 API 호출당 가격을 책정하며, x402를 통해 결제됩니다.

**질문: 어떤 네트워크가 지원되나요?** 답변: 현재 Base(메인넷)에서 USDC 결제가 가능합니다.

**질문: x402가 아닌 서비스도 등록할 수 있나요?** 답변: 아니요, x402와 호환되는 엔드포인트만 등록할 수 있습니다.
API를 x402와 호환되도록 설정하려면 [**판매자를 위한 빠른 시작**](https://docs.cdp.coinbase.com/x402/quickstart-for-sellers)을 참조하세요.


import { Callout } from "vocs/components";

## 클라이언트 / 서버 흐름

이 페이지에서는 x402 프로토콜에서 **클라이언트**와 **서버**의 역할과 책임을 설명합니다.
클라이언트와 서버의 역할을 이해하는 것은 x402를 사용하여 프로그래밍 방식 결제 서비스를 설계, 구축 또는 통합하는 데 필수적입니다.

<Callout type="info">
  클라이언트는 HTTP 요청을 하는 기술적 컴포넌트입니다. 일반적으로 리소스 구매자인 경우가 많습니다.

  서버는 요청에 응답하는 기술적 컴포넌트입니다. 일반적으로 리소스의 판매자입니다.
</Callout>

### 클라이언트 역할

클라이언트는 유료 리소스를 요청하는 엔티티입니다.

클라이언트에는 다음이 포함될 수 있습니다:

* 인간이 운영하는 애플리케이션
* 자율 AI 에이전트
* 사용자 또는 시스템을 대신하여 작동하는 프로그래밍 서비스

#### 책임

* **요청 시작**: 리소스 서버에 HTTP 요청을 보냅니다.
* **결제 요구 사항 처리**: HTTP 상태 코드 `402 Payment Required` 응답을 읽고 결제에 필요한 세부 정보를 추출합니다.
* **결제 Payload 준비**: 제공된 결제 요구 사항을 사용하여 유효한 결제 Payload를 구성합니다.
* **결제 Payload와 함께 요청 다시 제출**. `X-PAYMENT` 서명된 결제 Payload가 포함된 헤더로 요청을 다시 시도합니다.

클라이언트는 암호화폐 지갑 외에 계정, 자격 증명 또는 세션 토큰을 관리할 필요가 없습니다.
모든 상호작용은 상태를 저장하지 않으며 표준 HTTP 요청을 통해 이루어집니다.

### 서버 역할

서버는 서비스 이용에 대한 요금 지불을 요구하는 리소스 제공자입니다.

서버에는 다음이 포함될 수 있습니다.

* API 서비스
* 콘텐츠 제공자
* 수익화가 필요한 HTTP 접근 가능 리소스

#### 책임

* **결제 요구 사항 정의**: 인증되지 않은 요청에는 HTTP를 통해 `402 Payment Required` 코드로 응답하고 응답 본문(Body)에 필요한 모든 결제 세부 정보를 포함합니다.
* **결제 페이로드 검증**: 로컬 또는 퍼실리테이터를 이용하여 수신 결제 페이로드를 검증합니다.
* **트랜잭션 정산**: 검증이 성공적으로 완료되면 정산을 위해 결제를 제출합니다.
* **리소스 제공**: 결제가 확인되면 요청한 리소스를 클라이언트에게 반환합니다.

서버는 클라이언트 ID를 관리하거나 세션 상태를 유지할 필요가 없습니다. 확인 및 결제는 단위 요청 별로 처리됩니다.

### 작동 원리

클라이언트와 서버 간의 전체 결제 흐름에 대한 자세한 설명은 [**x402 작동 방식**](https://docs.cdp.coinbase.com/x402/core-concepts/how-it-works)을 참조하세요.

### 요약

x402 프로토콜에서:

* **클라이언트**는 리소스를 요청하고 서명된 결제 Payload를 제시합니다.
* **서버**는 결제 요구 사항을 정의하고, 거래를 검증하며, 결제가 성공적으로 완료되면 리소스를 제공합니다.

이러한 상호작용은 상태를 비저장(stateless)하고 HTTP 기반이며 인간 애플리케이션과 자동화된 AI 에이전트 모두와 호환됩니다.

더 알아보기:

* [**x402 작동 방식**](https://docs.cdp.coinbase.com/x402/core-concepts/how-it-works) - 전체 결제 흐름 보기
* [**퍼실리테이터**](https://docs.cdp.coinbase.com/x402/core-concepts/facilitator) - 서버가 지불을 확인하고 결제하는 방법
* [**HTTP 402**](https://docs.cdp.coinbase.com/x402/core-concepts/http-402) - 서버가 클라이언트에게 지불 요구 사항을 전달하는 방법


## 퍼실리테이터

이 페이지에서는 x402 프로토콜에서 **퍼실리테이터**의 역할을 설명합니다.

퍼실리테이터 서비스는 선택 사항이지만 권장되는 서비스로, 클라이언트(구매자)와 서버(판매자) 간의 결제 검증 및 결제 과정을 간소화합니다.

### 퍼실리테이터란 무엇인가요?

퍼실리테이터는 다음과 같은 서비스를 제공합니다.

* 클라이언트가 제출한 결제 Payload를 검증합니다.
* 서버를 대신하여 블록체인에서 결제를 처리합니다.

퍼실리테이터를 사용하면 서버는 블록체인에 직접 연결하거나 결제 검증 로직을 직접 구현할 필요가 없습니다. 이를 통해 운영 복잡성이 줄어들고 거래의 정확한 실시간 검증이 보장됩니다.

### 퍼실리테이터의 책임

* **결제 검증**: 클라이언트의 결제 Payload가 서버에서 선언한 결제 요구 사항을 충족하는지 확인합니다.
* **결제 정산**: 검증된 결제를 블록체인에 트랜잭션 형태로 제출하고 Confirmation이 이루어졌는지 모니터링합니다.
* **응답(Response)**: 검증 및 결제 결과를 서버로 반환하여 서버가 클라이언트의 요청을 이행할지 여부를 결정할 수 있도록 합니다.

퍼실리테이터는 자금을 보관하거나 보관자 역할을 하지 않습니다. 퍼실리테이터는 클라이언트가 제공한 서명된 Payload를 기반으로 체인상 거래의 검증 및 실행을 수행합니다.

### 왜 퍼실리테이터를 이용해야 하나요?

퍼실리테이터를 활용하면 다음과 같은 이점이 있습니다.

* **운영상의 복잡성 감소**: 서버가 블록체인 노드와 직접 상호 작용할 필요가 없습니다.
* **프로토콜 일관성**: 서비스 전반에 걸쳐 표준화된 검증 및 결제 흐름.
* **더욱 빠른 통합**: 서비스는 최소한의 블록체인과 관련된 개발만 하고, 결제 과정을 도입할 수 있습니다.

검증 및 결제를 로컬 환경에서 구현하는 것이 가능하지만, 퍼실리테이터를 활용하면 도입 속도가 빨라지고 프로토콜의 올바른 동작이 보장됩니다.

### CDP 퍼실리테이터

Coinbase Developer Platform(CDP)은 호스팅된 퍼실리테이터 서비스를 운영합니다.

CDP의 x402 퍼실리테이터 서비스는 다음을 제공합니다.

* **Base에서 수수료 없는 USDC 결제**: 현재 추가 수수료 없이 거래를 처리하므로 판매자는 결제 금액의 100%를 받을 수 있습니다.
* **USDC 전용 지원**: USDC를 결제 자산으로 단독으로 지원합니다(당분간).
* **고성능 정산**: 결제는 빠른 Confirmation 시간과 높은 처리량으로 Base Network에 제출됩니다.

CDP 퍼실리테이터를 시작하려면 [**판매자를 위한 빠른 시작**](https://docs.cdp.coinbase.com/x402/quickstart-for-sellers)을 참조하세요.

CDP 퍼실리테이터를 활용하면 판매자는 블록체인 인프라를 관리하지 않고도 빠르게 결제를 통합할 수 있으며, 구매자에게는 예측 가능하고 저렴한 경험을 제공할 수 있습니다.

### 이용 가능한 퍼실리테이터

이용 가능한 지원자와 그들이 지원하는 네트워크 목록을 보려면 [**네트워크 지원**](https://docs.cdp.coinbase.com/x402/network-support)을 참조하세요.

### 작동 원리

x402 지불 흐름 전체에 퍼실리테이터가 어떻게 적용되는지 알아보려면 [**x402 작동 방식**](https://docs.cdp.coinbase.com/x402/core-concepts/how-it-works)을 참조하세요.

### 요약

퍼실리테이터는 x402 프로토콜 내에서 독립적인 검증 및 결제 계층 역할을 합니다. 서버가 직접적인 블록체인 인프라 없이도 결제를 확인하고 온체인에서 거래를 제출할 수 있도록 지원합니다.

Coinbase가 호스팅 하는 퍼실리테이터 서비스는 Base에서 USDC 지불을 위한 즉시 사용 가능한 무료 환경을 제공함으로써 이를 더욱 간소화합니다.

더 알아보기:

* [**x402 작동 방식**](https://docs.cdp.coinbase.com/x402/core-concepts/how-it-works) - 전체 결제 흐름 보기
* [**네트워크 지원**](https://docs.cdp.coinbase.com/x402/network-support) - 이용 가능한 퍼실리테이터 및 네트워크 찾기
* [**HTTP 402**](https://docs.cdp.coinbase.com/x402/core-concepts/http-402) - 지불 요구 사항이 전달되는 방식을 이해합니다.


이 페이지에서는 최초 요청 단계부터 결제 완료 단계까지 x402에서의 전체 결제 흐름을 설명합니다.

### 개요

x402는 HTTP의 요청(Request)-응답(Response) 방식의 프로그래밍을 통해 결제를 지원합니다.
클라이언트가 유료 리소스를 요청하면 서버는 결제에 필요한 정보가 무엇인지 응답하고,
그에 따라 클라이언트는 결제에 필요한 정보를 제출하고 결제가 완료되면 서버는 해당 유료 리소스를 전달합니다.

### 결제 흐름

![x402-protocol-flow](/vocs-coinbase-x402-documentation-clone/x402-protocol-flow.avif)

#### 단계별 프로세스

1. **클라이언트가 HTTP 요청** - [**클라이언트**](https://docs.cdp.coinbase.com/x402/core-concepts/client-server)는 리소스 서버의 결제를 위한 특정 엔드포인트에 표준 HTTP 요청을 보냅니다.
2. **서버가 HTTP 402 코드로 응답** - 리소스 서버는 응답 본문(Body)에 결제 세부 정보와 함께
   [**HTTP 402 Payment Required**](https://docs.cdp.coinbase.com/x402/core-concepts/http-402) 상태 코드를 반환합니다.
3. **클라이언트가 결제를 생성** - 클라이언트는 결제 요구 사항을 검토하고 지정된 방식에 따라
   [**지갑**](https://docs.cdp.coinbase.com/x402/core-concepts/wallet)을 사용하여 결제 Payload를 생성합니다.
4. **클라이언트가 결제를 다시 제출** - 클라이언트가 동일한 HTTP 요청을 다시 전송하는데, 이번에는 서명된 결제 Payload가 포함된 `X-PAYMENT` 헤더를 포함합니다.
5. **서버가 결제를 검증** - 리소스 서버는 다음 중 하나를 통해 결제 payload를 검증합니다.
   * 로컬(자체 검증을 실행하는 경우)
   * [**퍼실리테이터**](https://docs.cdp.coinbase.com/x402/core-concepts/facilitator)를 통해서 (권장)
6. **퍼실리테이터 검증** - 퍼실리테이터를 이용하는 경우, 퍼실리테이터는 지불을 Scheme 및 네트워크 요구 사항에 맞춰 검증하고 검증 Response를 반환합니다.
7. **서버가 요청을 처리** - 결제가 유효하면 서버는 원래 요청을 처리합니다. 유효하지 않으면 402 응답을 다시 반환합니다.
8. **결제 정산** - 서버는 다음 중 하나를 통해 블록체인 결제를 시작합니다.
   * 블록체인에 직접 제출
   * 퍼실리테이터의 `/settle` 엔드포인트를 통해서 제출
9. **퍼실리테이터가 블록체인에 제출** - 퍼실리테이터는 결제 네트워크를 기반으로 블록체인에 거래를 브로드캐스트하고 확인을 기다립니다.
10. **결제 확인** - 체인상에서 확인되면, 퍼실리테이터는 결제 실행 응답을 반환합니다.
11. **서버가 리소스를 전달** - 서버는 다음을 포함한 200 OK 응답을 반환합니다.
    * 요청된 리소스 (응답 본문(Body))
    * 결제 세부 정보가 포함된 `X-PAYMENT-RESPONSE` HTTP 헤더

### 주요 구성 요소

[**클라이언트 및 서버**](https://docs.cdp.coinbase.com/x402/core-concepts/client-server) - 각 당사자의 역할 및 책임
[**퍼실리테이터**](https://docs.cdp.coinbase.com/x402/core-concepts/facilitator) - 지불 검증 및 정산을 처리하는 선택적 서비스
[**HTTP 402**](https://docs.cdp.coinbase.com/x402/core-concepts/http-402) - 결제 요구 사항이 전달되는 방식
[**네트워크 및 퍼실리테이터**](https://docs.cdp.coinbase.com/x402/network-support) - 사용 가능한 네트워크 및 퍼실리테이터 옵션

### 왜 이런 디자인을 했을까?

x402 프로토콜은 다음과 같이 설계되었습니다.

* **상태 비저장** - 세션이나 인증이 필요하지 않습니다.
* **HTTP 네이티브** - 기존 웹 인프라와 함께 작동합니다.
* **블록체인 독립적** - 퍼실리테이터를 통해 여러 네트워크 지원
* **개발자 친화적** - 표준 HTTP 라이브러리와의 간단한 통합

### 더 알아보기

* 결제를 받을 준비가 되셨나요? [**판매자를 위한 빠른 시작**](https://docs.cdp.coinbase.com/x402/quickstart-for-sellers)을 참조하세요.
* 결제를 원하시나요? [**구매자를 위한 빠른 시작**](https://docs.cdp.coinbase.com/x402/quickstart-for-buyers)을 참조하세요.
* 특정 네트워크를 찾고 계신가요? [**네트워크 지원**](https://docs.cdp.coinbase.com/x402/network-support)을 확인하세요.


## HTTP 402

HTTP 402 Payment Required 상태 코드는 존재는 했지만, 긴 시간동안 실제 사용은 되지 않고 있었습니다.
이제 x402가 해당 상태 코드를 활용해서 [**인터넷의 원죄**](https://economyofbits.substack.com/p/marc-andreessens-original-sin)를 해결합니다.

### HTTP 402란 무엇인가요?

[**HTTP 402**](https://datatracker.ietf.org/doc/html/rfc7231#section-6.5.2)는 리소스에 접근하려면 결제가 필요하다는 것을 나타내는 표준이지만
거의 사용되지 않는 HTTP 응답 상태 코드입니다.

x402에서 이 상태 코드는 다음을 위해 활성화됩니다.

* 고객(구매자 또는 AI 에이전트)에게 지불이 필요하다는 사실을 알립니다.
* 금액, 통화, 상품을 받을 주소 등 결제 세부 정보를 전달합니다.
* 결제를 프로그래밍 방식으로 완료하는 데 필요한 정보를 제공합니다.

### x402가 HTTP 402를 사용하는 이유

HTTP 402의 주요 목적은 특히 다음과 같은 경우 웹 리소스에 액세스하기 위한 원활하고 API 기반 결제를 가능하게 하는 것입니다.

* 기계 간(M2M) 결제(예: AI 에이전트).
* API 호출이나 유료 콘텐츠와 같은 사용량 기반 모델.
* 계좌 생성이나 전통적인 결제 수단 없이 소액 결제가 가능합니다.

402 상태 코드를 사용하면 x402 프로토콜이 기본적으로 웹과 호환되고 모든 HTTP 기반 서비스에 쉽게 통합될 수 있습니다.

### 요약

HTTP 402는 x402 프로토콜의 기반이며, 서비스가 HTTP 응답 내에서 직접 결제 요구 사항을 선언할 수 있도록 합니다. 이는 다음과 같습니다.

* 결제가 필요하다는 신호
* 필요한 결제 세부 정보를 전달합니다
* 표준 HTTP 워크플로와 완벽하게 통합됩니다.

### 더 알아보기

* [**x402 작동 방식**](https://docs.cdp.coinbase.com/x402/core-concepts/how-it-works) - HTTP 402가 전체 결제 흐름에 어떻게 적용되는지 확인하세요.
* [**클라이언트 및 서버**](https://docs.cdp.coinbase.com/x402/core-concepts/client-server) - x402 프로토콜의 역할 이해
* [**판매자를 위한 빠른 시작**](https://docs.cdp.coinbase.com/x402/quickstart-for-sellers) - HTTP 402 응답 구현 시작


## 월렛

이 페이지에서는 x402 프로토콜에서 **월렛**의 역할을 설명합니다.

x402에서 월렛은 결제 메커니즘이자 구매자와 판매자의 고유한 신원 확인 수단입니다.
지갑 주소는 결제를 보내고 받고 확인하는 데 사용되는 동시에 프로토콜 내에서 식별자 역할을 합니다.

### 월렛의 역할

#### 구매자를 위해

구매자는 월렛을 다음과 같은 용도로 사용합니다.

* USDC 매장
* 결제 Payload 서명
* 프로그래밍 방식으로 온체인 결제 승인

월렛을 사용하면 AI 에이전트를 포함한 구매자가 계정 생성이나 자격 증명 관리 없이 거래할 수 있습니다.

#### 판매자를 위해

판매자는 월렛을 다음과 같은 용도로 사용합니다.

* USDC 지불 받기
* 서버 구성 내에서 결제 대상을 정의합니다.

판매자의 월렛 주소는 구매자에게 제공되는 지불 요구 사항에 포함됩니다.

[**CDP의 서버 월렛**](https://docs.cdp.coinbase.com/server-wallets/v1/concepts/wallets)은 프로그래밍 방식 결제와 안전한 키 관리를 위해 권장하는 옵션입니다.

### 요약

* 월렛은 x402에서 프로그래밍 방식의 허가 없는 결제를 가능하게 합니다.
* 구매자는 월렛을 사용해 서비스 비용을 지불합니다.
* 판매자는 월렛을 사용해 결제를 받습니다.
* 월렛 주소는 프로토콜 내에서 고유 식별자 역할도 합니다.

더 알아보기:

* [**x402 작동 방식**](https://docs.cdp.coinbase.com/x402/core-concepts/how-it-works) - 월렛이 결제 흐름에 어떻게 적용되는지 확인하세요.
* [**클라이언트 및 서버**](https://docs.cdp.coinbase.com/x402/core-concepts/client-server) - 구매자와 판매자 역할 이해
* [**판매자를 위한 빠른 시작**](https://docs.cdp.coinbase.com/x402/quickstart-for-sellers) - 수신 월렛 설정
* [**구매자를 위한 빠른 시작**](https://docs.cdp.coinbase.com/x402/quickstart-for-buyers) - 결제 월렛 구성

